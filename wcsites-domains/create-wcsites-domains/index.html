<!doctype html><html lang=en class="js csstransforms3d"><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=generator content="Hugo 0.53"><meta name=description content="Sample for creating a WebCenter Sites domain home on an existing PV or PVC, and the domain resource YAML file for deploying the generated WebCenter Sites domain."><link rel=icon href=/ghpages-test/images/favicon.png type=image/png><title>Create WebCenter Sites domains :: Oracle Fusion Middleware on Kubernetes</title><link href=/ghpages-test/css/nucleus.css?1584947815 rel=stylesheet><link href=/ghpages-test/css/fontawesome-all.min.css?1584947815 rel=stylesheet><link href=/ghpages-test/css/hybrid.css?1584947815 rel=stylesheet><link href=/ghpages-test/css/featherlight.min.css?1584947815 rel=stylesheet><link href=/ghpages-test/css/perfect-scrollbar.min.css?1584947815 rel=stylesheet><link href=/ghpages-test/css/auto-complete.css?1584947815 rel=stylesheet><link href=/ghpages-test/css/atom-one-dark-reasonable.css?1584947815 rel=stylesheet><link href=/ghpages-test/css/theme.css?1584947815 rel=stylesheet><link href=/ghpages-test/css/hugo-theme.css?1584947815 rel=stylesheet><script src=/ghpages-test/js/jquery-3.3.1.min.js?1584947815></script><style>:root #header+#content>#left>#rlblock_left{display:none!important}</style></head><body data-url=/ghpages-test/wcsites-domains/create-wcsites-domains/><nav id=sidebar><div id=header-wrapper><div id=header><a id=logo href=/ghpages-test/><img src=/ghpages-test//images/fmw_12c_12_2_1_4_0-logo.png height=100><br><b>Oracle Fusion Middleware on Kubernetes</b></a></div><div class=searchbox><label for=search-by><i class="fas fa-search"></i></label><input data-search-input id=search-by type=search placeholder=Search...>
<span data-search-clear><i class="fas fa-times"></i></span></div><script type=text/javascript src=/ghpages-test/js/lunr.min.js?1584947815></script><script type=text/javascript src=/ghpages-test/js/auto-complete.js?1584947815></script><script type=text/javascript>var baseurl="\/ghpages-test\/";</script><script type=text/javascript src=/ghpages-test/js/search.js?1584947815></script></div><div class=highlightable><ul class=topics><li><a class=padding href=/fmw-kubernetes/>Home</a></li><li data-nav-id=/ghpages-test/soa-domains/ title="Oracle SOA Suite" class=dd-item><a href=/ghpages-test/soa-domains/>Oracle SOA Suite</a><ul><li data-nav-id=/ghpages-test/soa-domains/prerequisites/ title=Prerequisites class=dd-item><a href=/ghpages-test/soa-domains/prerequisites/><b>1. </b>Prerequisites</a></li><li data-nav-id=/ghpages-test/soa-domains/prepare-your-environment/ title="Prepare your environment" class=dd-item><a href=/ghpages-test/soa-domains/prepare-your-environment/><b>2. </b>Prepare your environment</a></li><li data-nav-id=/ghpages-test/soa-domains/create-soa-domains/ title="Create SOA domains" class=dd-item><a href=/ghpages-test/soa-domains/create-soa-domains/><b>3. </b>Create SOA domains</a></li><li data-nav-id=/ghpages-test/soa-domains/manage-soa-domains/ title="Manage SOA Domains" class=dd-item><a href=/ghpages-test/soa-domains/manage-soa-domains/><b>4. </b>Manage SOA Domains</a><ul><li data-nav-id=/ghpages-test/soa-domains/manage-soa-domains/configuring-load-balancer/ title="Configuring a load balancer for SOA Domains" class=dd-item><a href=/ghpages-test/soa-domains/manage-soa-domains/configuring-load-balancer/><b>1. </b>Configuring a load balancer for SOA Domains</a></li><li data-nav-id=/ghpages-test/soa-domains/manage-soa-domains/monitoring-soa-domains/ title="Monitoring a SOA domain" class=dd-item><a href=/ghpages-test/soa-domains/manage-soa-domains/monitoring-soa-domains/><b>2. </b>Monitoring a SOA domain</a></li><li data-nav-id=/ghpages-test/soa-domains/manage-soa-domains/delete-domain-home/ title="Delete the SOA domain home" class=dd-item><a href=/ghpages-test/soa-domains/manage-soa-domains/delete-domain-home/><b>3. </b>Delete the SOA domain home</a></li><li data-nav-id=/ghpages-test/soa-domains/manage-soa-domains/supportjdev/ title="Deploying SOA Composites from Oracle JDeveloper" class=dd-item><a href=/ghpages-test/soa-domains/manage-soa-domains/supportjdev/><b>4. </b>Deploying SOA Composites from Oracle JDeveloper</a></li><li data-nav-id=/ghpages-test/soa-domains/manage-soa-domains/enablingt3/ title="Expose T3 protocol for Managed Servers" class=dd-item><a href=/ghpages-test/soa-domains/manage-soa-domains/enablingt3/><b>5. </b>Expose T3 protocol for Managed Servers</a></li><li data-nav-id=/ghpages-test/soa-domains/manage-soa-domains/persisting-soa-adapters-customizations/ title="Persisting SOA Adapters Customizations" class=dd-item><a href=/ghpages-test/soa-domains/manage-soa-domains/persisting-soa-adapters-customizations/><b>6. </b>Persisting SOA Adapters Customizations</a></li></ul></li><li data-nav-id=/ghpages-test/soa-domains/patch-soa-domains/ title="Patch SOA domains" class=dd-item><a href=/ghpages-test/soa-domains/patch-soa-domains/><b>5. </b>Patch SOA domains</a></li><li data-nav-id=/ghpages-test/soa-domains/known-issues/ title="Known Issues" class=dd-item><a href=/ghpages-test/soa-domains/known-issues/><b>6. </b>Known Issues</a></li><li data-nav-id=/ghpages-test/soa-domains/release-notes/ title="Release Notes" class=dd-item><a href=/ghpages-test/soa-domains/release-notes/>Release Notes</a></li></ul></li><li data-nav-id=/ghpages-test/wcsites-domains/ title="Oracle WebCenter Sites" class="dd-item 
        parent"><a href=/ghpages-test/wcsites-domains/>Oracle WebCenter Sites</a><ul><li data-nav-id=/ghpages-test/wcsites-domains/pre-requisites/ title=Pre-requisites class=dd-item><a href=/ghpages-test/wcsites-domains/pre-requisites/><b>1. </b>Pre-requisites</a></li><li data-nav-id=/ghpages-test/wcsites-domains/prepare-your-environment/ title="Prepare your environment" class=dd-item><a href=/ghpages-test/wcsites-domains/prepare-your-environment/><b>2. </b>Prepare your environment</a></li><li data-nav-id=/ghpages-test/wcsites-domains/create-wcsites-domains/ title="Create WebCenter Sites domains" class="dd-item 
        parent
        active"><a href=/ghpages-test/wcsites-domains/create-wcsites-domains/><b>3. </b>Create WebCenter Sites domains</a></li><li data-nav-id=/ghpages-test/wcsites-domains/manage-wcsites-domains/ title="Manage WebCenter Sites domains" class=dd-item><a href=/ghpages-test/wcsites-domains/manage-wcsites-domains/><b>4. </b>Manage WebCenter Sites domains</a><ul><li data-nav-id=/ghpages-test/wcsites-domains/manage-wcsites-domains/loadbalancer-traefik-setup-for-wcsites-domain-setup-on-k8s/ title="a. Using Traefik Loadbalancer" class=dd-item><a href=/ghpages-test/wcsites-domains/manage-wcsites-domains/loadbalancer-traefik-setup-for-wcsites-domain-setup-on-k8s/>a. Using Traefik Loadbalancer</a></li><li data-nav-id=/ghpages-test/wcsites-domains/manage-wcsites-domains/loadbalancer-voyager-setup-for-wcsites-domain-setup-on-k8s/ title="b. Using Voyager Loadbalancer" class=dd-item><a href=/ghpages-test/wcsites-domains/manage-wcsites-domains/loadbalancer-voyager-setup-for-wcsites-domain-setup-on-k8s/>b. Using Voyager Loadbalancer</a></li><li data-nav-id=/ghpages-test/wcsites-domains/manage-wcsites-domains/elasticsearch-integration-with-wls-operator-wls-server-logs/ title="c. ELK Integration for Logs" class=dd-item><a href=/ghpages-test/wcsites-domains/manage-wcsites-domains/elasticsearch-integration-with-wls-operator-wls-server-logs/>c. ELK Integration for Logs</a></li><li data-nav-id=/ghpages-test/wcsites-domains/manage-wcsites-domains/weblogic-logging-exporter-setup/ title="d. Publish logs to Elasticsearch" class=dd-item><a href=/ghpages-test/wcsites-domains/manage-wcsites-domains/weblogic-logging-exporter-setup/>d. Publish logs to Elasticsearch</a></li><li data-nav-id=/ghpages-test/wcsites-domains/manage-wcsites-domains/weblogic-monitoring-exporter-setup/ title="e. Monitor a WebCenter Sites domain" class=dd-item><a href=/ghpages-test/wcsites-domains/manage-wcsites-domains/weblogic-monitoring-exporter-setup/>e. Monitor a WebCenter Sites domain</a></li></ul></li><li data-nav-id=/ghpages-test/wcsites-domains/known-issues/ title="Known Issues in WCSites" class=dd-item><a href=/ghpages-test/wcsites-domains/known-issues/><b>6. </b>Known Issues in WCSites</a></li><li data-nav-id=/ghpages-test/wcsites-domains/release-notes/ title="Release Notes" class=dd-item><a href=/ghpages-test/wcsites-domains/release-notes/>Release Notes</a></li></ul></li></ul><section id=footer><p>Created with <i class="fas fa-heart"></i>from <a href=https://www.oracle.com>Oracle</a></p><p>&nbsp;</p><p><a href=https://github.com/oracle/fmw-kubernetes><i class="fab fa-github"></i>GitHub repo</a></p><p><a href=https://weblogic-slack-inviter.herokuapp.com/><i class="fab fa-slack"></i>Public Slack #</a></p></section></div></nav><section id=body><div id=overlay></div><div class="padding highlightable"><div><div id=top-bar><div id=breadcrumbs itemscope itemtype=http://data-vocabulary.org/Breadcrumb><span id=sidebar-toggle-span><a href=# id=sidebar-toggle data-sidebar-toggle><i class="fas fa-bars"></i></a></span><span id=toc-menu><i class="fas fa-list-alt"></i></span><span class=links><a href=/ghpages-test/>Oracle Fusion Middleware on Kubernetes</a> > <a href=/ghpages-test/wcsites-domains/>Oracle WebCenter Sites</a> > Create WebCenter Sites domains</span></div><div class=progress><div class=wrapper><nav id=TableOfContents><ul><li><ul><li><ul><li><ul><li><a href=#contents>Contents</a></li><li><a href=#introduction>Introduction</a></li><li><a href=#prerequisites>Prerequisites</a></li><li><a href=#prepare-the-webcenter-sites-domain-creation-input-file>Prepare the WebCenter Sites Domain Creation Input File</a><ul><li><a href=#configuration-parameters>Configuration parameters</a></li></ul></li><li><a href=#create-the-webcenter-sites-domain>Create the WebCenter Sites Domain</a></li><li><a href=#initialize-the-webcenter-sites-domain>Initialize the WebCenter Sites Domain</a></li><li><a href=#verify-the-webcenter-sites-domain>Verify the WebCenter Sites Domain</a><ul><li><a href=#verify-the-pods>Verify the Pods</a></li><li><a href=#verify-the-services>Verify the Services</a></li></ul></li><li><a href=#expose-webcenter-sites-services>Expose WebCenter Sites Services</a></li><li><a href=#load-balance-with-an-ingress-controller-or-a-web-server>Load Balance With an Ingress Controller or A Web Server</a></li><li><a href=#configure-webcenter-sites>Configure WebCenter Sites</a></li></ul></li></ul></li></ul></li></ul></nav></div></div></div></div><div id=head-tags></div><div id=body-inner><h1>Create WebCenter Sites domains</h1><div class="notices warning"><p>Oracle WebCenter Sites is currently supported for non-production use in Docker and Kubernetes. The information provided
in this document is a <em>preview</em> for early adopters who wish to experiment with Oracle WebCenter Sites in Kubernetes before
it is supported for production use.</p></div><h4 id=contents>Contents</h4><ul><li><a href=#introduction>Introduction</a></li><li><a href=#prerequisites>Prerequisites</a></li><li><a href=#prepare-the-webcenter-sites-domain-creation-input-file>Prepare the WebCenter Sites Domain Creation Input File</a></li><li><a href=#create-the-webcenter-sites-domain>Create the WebCenter Sites Domain</a></li><li><a href=#initialize-the-webcenter-sites-domain>Initialize the WebCenter Sites Domain</a></li><li><a href=#verify-the-webcenter-sites-domain>Verify the WebCenter Sites Domain</a></li><li><a href=#expose-webcenter-sites-services>Expose WebCenter Sites Services</a></li><li><a href=#load-balance-with-an-ingress-controller-or-a-web-server>Load Balance With an Ingress Controller or A Web Server</a></li><li><a href=#configure-webcenter-sites>Configure WebCenter Sites</a></li></ul><h4 id=introduction>Introduction</h4><p>This document details on how to use sample scripts to demonstrate the creation of a WebCenter Sites domain home on an
existing Kubernetes persistent volume (PV) and persistent volume claim (PVC). The scripts
also generate the domain YAML file, which can then be used to start the Kubernetes
artifacts of the corresponding domain.</p><h4 id=prerequisites>Prerequisites</h4><ul><li>Ensure that you have completed all of the steps under <a href=/ghpages-test/wcsites-domains/prepare-your-environment/>prepare-your-environment</a>.</li><li>Ensure that the database and the WebLogic Kubernetes operator is up.</li></ul><h4 id=prepare-the-webcenter-sites-domain-creation-input-file>Prepare the WebCenter Sites Domain Creation Input File</h4><p>If required, domain creation inputs can be customized by editing <code>create-domain-inputs.yaml</code> as described below:</p><p>Please note that the sample scripts for the WebCenter Sites domain deployment are available from the previously downloaded repository at <code>kubernetes/samples/scripts/create-wcsites-domain/domain-home-on-pv/</code>.</p><p>Make a copy of the <code>create-domain-inputs.yaml</code> file before updating the default values.</p><p>The default domain created by the script has the following characteristics:</p><ul><li>An Administration Server named <code>AdminServer</code> listening on port <code>7001</code>.</li><li>A configured cluster named <code>wcsites_cluster</code> of size <code>5</code>.</li><li>Managed Server, named <code>wcsites_server1</code>, listening on port <code>8001</code>.</li><li>Log files that are located in <code>/shared/logs/&lt;domainUID&gt;</code>.</li></ul><h5 id=configuration-parameters>Configuration parameters</h5><p>The following parameters can be provided in the inputs file:</p><table><thead><tr><th>Parameter</th><th>Definition</th><th>Default</th></tr></thead><tbody><tr><td><code>adminPort</code></td><td>Port number for the Administration Server inside the Kubernetes cluster.</td><td><code>7001</code></td></tr><tr><td><code>adminServerName</code></td><td>Name of the Administration Server.</td><td><code>AdminServer</code></td></tr><tr><td><code>clusterName</code></td><td>Name of the WebLogic cluster instance to generate for the domain. By default the cluster name is <code>wcsites_cluster</code> for the WebCenter Sites domain.</td><td><code>wcsites_cluster</code></td></tr><tr><td><code>configuredManagedServerCount</code></td><td>Number of Managed Server instances for the domain.</td><td><code>3</code></td></tr><tr><td><code>createDomainFilesDir</code></td><td>Directory on the host machine to locate all the files that you need to create a WebLogic domain, including the script that is specified in the <code>createDomainScriptName</code> property. By default, this directory is set to the relative path <code>wlst</code>, and the create script will use the built-in WLST offline scripts in the <code>wlst</code> directory to create the WebLogic domain. It can also be set to the relative path <code>wdt</code>, and then the built-in WDT scripts will be used instead. An absolute path is also supported to point to an arbitrary directory in the file system. The built-in scripts can be replaced by the user-provided scripts or model files as long as those files are in the specified directory. Files in this directory are put into a Kubernetes config map, which in turn is mounted to the <code>createDomainScriptsMountPath</code>, so that the Kubernetes pod can use the scripts and supporting files to create a domain home.</td><td><code>wlst</code></td></tr><tr><td><code>createDomainScriptsMountPath</code></td><td>Mount path where the create domain scripts are located inside a pod. The <code>create-domain.sh</code> script creates a Kubernetes job to run the script (specified in the <code>createDomainScriptName</code> property) in a Kubernetes pod to create a domain home. Files in the <code>createDomainFilesDir</code> directory are mounted to this location in the pod, so that the Kubernetes pod can use the scripts and supporting files to create a domain home.</td><td><code>/u01/weblogic</code></td></tr><tr><td><code>createDomainScriptName</code></td><td>Script that the create domain script uses to create a WebLogic domain. The <code>create-domain.sh</code> script creates a Kubernetes job to run this script to create a domain home. The script is located in the in-pod directory that is specified in the <code>createDomainScriptsMountPath</code> property. If you need to provide your own scripts to create the domain home, instead of using the built-it scripts, you must use this property to set the name of the script that you want the create domain job to run.</td><td><code>create-domain-job.sh</code></td></tr><tr><td><code>domainHome</code></td><td>Home directory of the WebCenter Sites domain. If not specified, the value is derived from the <code>domainUID</code> as <code>/shared/domains/&lt;domainUID&gt;</code>.</td><td><code>/u01/oracle/user_projects/domains/wcsitesinfra</code></td></tr><tr><td><code>domainPVMountPath</code></td><td>Mount path of the domain persistent volume.</td><td><code>/u01/oracle/user_projects/domains</code></td></tr><tr><td><code>domainUID</code></td><td>Unique ID that will be used to identify this particular domain. Used as the name of the generated WebLogic domain as well as the name of the Kubernetes domain resource. This ID must be unique across all domains in a Kubernetes cluster. This ID cannot contain any character that is not valid in a Kubernetes service name.</td><td><code>wcsitesinfra</code></td></tr><tr><td><code>exposeAdminNodePort</code></td><td>Boolean indicating if the Administration Server is exposed outside of the Kubernetes cluster.</td><td><code>false</code></td></tr><tr><td><code>exposeAdminT3Channel</code></td><td>Boolean indicating if the T3 administrative channel is exposed outside the Kubernetes cluster.</td><td><code>false</code></td></tr><tr><td><code>image</code></td><td>WebCenter Sites Docker image. The Operator requires WebCenter Sites release 12.2.1.4.0. Refer to <a href=https://github.com/oracle/docker-images/tree/master/OracleWebCenterSites/dockerfiles/12.2.1.4>WebCenter Sites Docker Image</a> for details on how to obtain or create the image.</td><td><code>oracle/wcsites:12.2.1.4</code></td></tr><tr><td><code>imagePullPolicy</code></td><td>WebLogic Docker image pull policy. Legal values are <code>IfNotPresent</code>, <code>Always</code>, or <code>Never</code></td><td><code>IfNotPresent</code></td></tr><tr><td><code>imagePullSecretName</code></td><td>Name of the Kubernetes secret to access the Docker Store to pull the WebLogic Server Docker image. The presence of the secret will be validated when this parameter is specified.</td><td></td></tr><tr><td><code>includeServerOutInPodLog</code></td><td>Boolean indicating whether to include the server.out to the pod&rsquo;s stdout.</td><td><code>true</code></td></tr><tr><td><code>initialManagedServerReplicas</code></td><td>Number of Managed Server to initially start for the domain.</td><td><code>1</code></td></tr><tr><td><code>javaOptions</code></td><td>Java options for starting the Administration Server and Managed Servers. A Java option can include references to one or more of the following pre-defined variables to obtain WebLogic domain information: <code>$(DOMAIN_NAME)</code>, <code>$(DOMAIN_HOME)</code>, <code>$(ADMIN_NAME)</code>, <code>$(ADMIN_PORT)</code>, and <code>$(SERVER_NAME)</code>.</td><td><code>-Dweblogic.StdoutDebugEnabled=false</code></td></tr><tr><td><code>logHome</code></td><td>The in-pod location for the domain log, server logs, server out, and Node Manager log files. If not specified, the value is derived from the <code>domainUID</code> as <code>/shared/logs/&lt;domainUID&gt;</code>.</td><td><code>/u01/oracle/user_projects/domains/logs/wcsitesinfra</code></td></tr><tr><td><code>managedServerNameBase</code></td><td>Base string used to generate Managed Server names.</td><td><code>wcsites_server</code></td></tr><tr><td><code>managedServerPort</code></td><td>Port number for each Managed Server.</td><td><code>8001</code></td></tr><tr><td><code>namespace</code></td><td>Kubernetes namespace in which to create the domain.</td><td><code>wcsites-ns</code></td></tr><tr><td><code>persistentVolumeClaimName</code></td><td>Name of the persistent volume claim created to host the domain home. If not specified, the value is derived from the <code>domainUID</code> as <code>&lt;domainUID&gt;-weblogic-sample-pvc</code>.</td><td><code>wcsitesinfra-domain-pvc</code></td></tr><tr><td><code>productionModeEnabled</code></td><td>Boolean indicating if production mode is enabled for the domain.</td><td><code>true</code></td></tr><tr><td><code>serverStartPolicy</code></td><td>Determines which WebLogic Server instances will be started. Legal values are <code>NEVER</code>, <code>IF_NEEDED</code>, <code>ADMIN_ONLY</code>.</td><td><code>IF_NEEDED</code></td></tr><tr><td><code>t3ChannelPort</code></td><td>Port for the T3 channel of the NetworkAccessPoint.</td><td><code>30012</code></td></tr><tr><td><code>t3PublicAddress</code></td><td>Public address for the T3 channel. This should be set to the public address of the Kubernetes cluster. This would typically be a load balancer address.<p>For development environments only: In a single server (all-in-one) Kubernetes deployment, this may be set to the address of the master, or at the very least, it must be set to the address of one of the worker nodes.</td><td>If not provided, the script will attempt to set it to the IP address of the Kubernetes cluster.</td></tr><tr><td><code>weblogicCredentialsSecretName</code></td><td>Name of the Kubernetes secret for the Administration Server&rsquo;s user name and password. If not specified, then the value is derived from the <code>domainUID</code> as <code>&lt;domainUID&gt;-weblogic-credentials</code>.</td><td><code>wcsites-domain-credentials</code></td></tr><tr><td><code>weblogicImagePullSecretName</code></td><td>Name of the Kubernetes secret for the Docker Store, used to pull the WebLogic Server image.</td><td></td></tr><tr><td><code>serverPodCpuRequest</code>, <code>serverPodMemoryRequest</code>, <code>serverPodCpuCLimit</code>, <code>serverPodMemoryLimit</code></td><td>The maximum amount of compute resources allowed and minimum amount of compute resources required for each server pod. Please refer to the Kubernetes documentation on <code>Managing Compute Resources for Containers</code> for details.</td><td>Resource requests and resource limits are not specified. Refer to <a href=../pre-requisites/#webcenter-sites-cluster-sizing-recommendations>WebCenter Sites Cluster Sizing Recommendations</a> for more details.</td></tr><tr><td><code>rcuSchemaPrefix</code></td><td>The schema prefix to use in the database, for example <code>WCS1</code>. You may wish to make this the same as the domainUID in order to simplify matching domains to their RCU schemas.</td><td><code>WCS1</code></td></tr><tr><td><code>rcuDatabaseURL</code></td><td>The database URL.</td><td><code>oracle-db.wcsitesdb-ns.svc.cluster.local:1521/devpdb.k8s</code></td></tr><tr><td><code>rcuCredentialsSecret</code></td><td>The loadbalancer hostname to be provided.</td><td><code>wcsites-rcu-credentials</code></td></tr><tr><td><code>loadBalancerHostName</code></td><td>Hostname for the final url accessible outside K8S environment.</td><td><code>abc.def.com</code></td></tr><tr><td><code>loadBalancerPortNumber</code></td><td>Port for the final url accessible outside K8S environment.</td><td><code>30305</code></td></tr><tr><td><code>loadBalancerProtocol</code></td><td>Protocol for the final url accessible outside K8S environment.</td><td><code>http</code></td></tr><tr><td><code>loadBalancerType</code></td><td>Loadbalancer name that will be used. Example: Traefik or &ldquo;&rdquo;</td><td><code>traefik</code></td></tr><tr><td><code>unicastPort</code></td><td>Starting range of uniciast port that application will use.</td><td><code>50000</code></td></tr><tr><td><code>sitesSamples</code></td><td>Sites to be installed without samples sites by default, else true.</td><td><code>false</code></td></tr></tbody></table><p>You can form the names of the Kubernetes resources in the generated YAML files with the value of these properties
specified in the <code>create-domain-inputs.yaml</code> file: <code>adminServerName</code> , <code>clusterName</code> and <code>managedServerNameBase</code> . Characters that are invalid in a Kubernetes service name are converted to valid values in the
generated YAML files. For example, an uppercase letter is converted to a lowercase letter and an underscore (&rdquo;_&ldquo;) is converted to a
hyphen (&ldquo;-&rdquo;) .</p><p>The sample demonstrates how to create a WebCenter Sites domain home and associated Kubernetes resources for a domain
that has one cluster only. In addition, the sample provides the capability for users to supply their own scripts
to create the domain home for other use cases. You can modify the generated domain YAML file to include more use cases.</p><h4 id=create-the-webcenter-sites-domain>Create the WebCenter Sites Domain</h4><ol><li><p>Understanding the syntax of the create-domain.sh script:</p><pre><code>$ ./create-domain.sh \
 -i create-domain-inputs.yaml \
 -o /&lt;path to output-directory&gt;
</code></pre><p>The script performs the following functions:</p><ul><li>Creates a directory for the generated Kubernetes YAML files for this domain if it does not
already exist. The path name is <code>/&lt;path to output-directory&gt;/weblogic-domains/&lt;domainUID&gt;</code>.
If the directory already exists, remove its content before using this script.</li><li>Creates a Kubernetes job that will start up a utility WebCenter Sites container and run
offline WLST scripts to create the domain on the shared storage.</li><li>Runs and waits for the job to finish.</li><li>Creates a Kubernetes domain YAML file, <code>domain.yaml</code>, in the directory that is created above.
This YAML file can be used to create the Kubernetes resource using the <code>kubectl create -f</code>
or <code>kubectl apply -f</code> command:<br></li></ul><pre><code>   $ kubectl apply -f ../&lt;path to output-directory&gt;/weblogic-domains/&lt;domainUID&gt;/domain.yaml
</code></pre><ul><li>Creates a convenient utility script, <code>delete-domain-job.yaml</code>, to clean up the domain home
created by the create script.</li></ul></li><li><p>Now, run the <code>create-domain.sh</code> sample script below, pointing it at the create-domain-inputs inputs file and an output directory like below:</p><pre><code class=language-bash>bash-4.2$ rm -rf kubernetes/samples/scripts/create-wcsites-domain/output/weblogic-domains
     
bash-4.2$ sh kubernetes/samples/scripts/create-wcsites-domain/domain-home-on-pv/create-domain.sh \
    -i kubernetes/samples/scripts/create-wcsites-domain/domain-home-on-pv/create-domain-inputs.yaml \
    -o kubernetes/samples/scripts/create-wcsites-domain/output
     
Input parameters being used
export version=&quot;create-weblogic-sample-domain-inputs-v1&quot;
export adminPort=&quot;7001&quot;
export adminServerName=&quot;adminserver&quot;
export domainUID=&quot;wcsitesinfra&quot;
export domainHome=&quot;/u01/oracle/user_projects/domains/$domainUID&quot;
export serverStartPolicy=&quot;IF_NEEDED&quot;
export clusterName=&quot;wcsites_cluster&quot;
export configuredManagedServerCount=&quot;3&quot;
export initialManagedServerReplicas=&quot;1&quot;
export managedServerNameBase=&quot;wcsites_server&quot;
export managedServerPort=&quot;8001&quot;
export image=&quot;oracle/wcsites:12.2.1.4&quot;
export imagePullPolicy=&quot;IfNotPresent&quot;
export productionModeEnabled=&quot;true&quot;
export weblogicCredentialsSecretName=&quot;wcsitesinfra-domain-credentials&quot;
export includeServerOutInPodLog=&quot;true&quot;
export logHome=&quot;/u01/oracle/user_projects/domains/logs/$domainUID&quot;
export t3ChannelPort=&quot;30012&quot;
export exposeAdminT3Channel=&quot;false&quot;
export adminNodePort=&quot;30701&quot;
export exposeAdminNodePort=&quot;false&quot;
export namespace=&quot;wcsites-ns&quot;
javaOptions=-Dweblogic.StdoutDebugEnabled=false -Xms2g
export persistentVolumeClaimName=&quot;wcsitesinfra-domain-pvc&quot;
export domainPVMountPath=&quot;/u01/oracle/user_projects/domains&quot;
export createDomainScriptsMountPath=&quot;/u01/weblogic&quot;
export createDomainScriptName=&quot;create-domain-job.sh&quot;
export createDomainFilesDir=&quot;wlst&quot;
export rcuSchemaPrefix=&quot;WCS140&quot;
export rcuDatabaseURL=&quot;blr00bbf.in.oracle.com:1521/RCUDBS&quot;
export rcuCredentialsSecret=&quot;wcsitesinfra-rcu-credentials&quot;
export loadBalancerHostName=&quot;blr00aqi.in.oracle.com&quot;
export loadBalancerPortNumber=&quot;30305&quot;
export loadBalancerProtocol=&quot;http&quot;
export loadBalancerType=&quot;traefik&quot;
export unicastPort=&quot;50000&quot;
export sitesSamples=&quot;true&quot;
    
Generating kubernetes/samples/scripts/create-wcsites-domain/output/weblogic-domains/wcsitesinfra/create-domain-job.yaml
Generating kubernetes/samples/scripts/create-wcsites-domain/output/weblogic-domains/wcsitesinfra/delete-domain-job.yaml
Generating kubernetes/samples/scripts/create-wcsites-domain/output/weblogic-domains/wcsitesinfra/domain.yaml
Checking to see if the secret wcsitesinfra-domain-credentials exists in namespace wcsites-ns
configmap/wcsitesinfra-create-fmw-infra-sample-domain-job-cm created
Checking the configmap wcsitesinfra-create-fmw-infra-sample-domain-job-cm was created
configmap/wcsitesinfra-create-fmw-infra-sample-domain-job-cm labeled
Checking if object type job with name wcsitesinfra-create-fmw-infra-sample-domain-job exists
No resources found.
$loadBalancerType is NOT empty
Creating the domain by creating the job kubernetes/samples/scripts/create-wcsites-domain/output/weblogic-domains/wcsitesinfra/create-domain-job.yaml
job.batch/wcsitesinfra-create-fmw-infra-sample-domain-job created
Waiting for the job to complete...
status on iteration 1 of 20
pod wcsitesinfra-create-fmw-infra-sample-domain-job-6l7zh status is Running
status on iteration 2 of 20
pod wcsitesinfra-create-fmw-infra-sample-domain-job-6l7zh status is Running
status on iteration 3 of 20
pod wcsitesinfra-create-fmw-infra-sample-domain-job-6l7zh status is Running
status on iteration 4 of 20
pod wcsitesinfra-create-fmw-infra-sample-domain-job-6l7zh status is Running
status on iteration 5 of 20
pod wcsitesinfra-create-fmw-infra-sample-domain-job-6l7zh status is Running
status on iteration 6 of 20
pod wcsitesinfra-create-fmw-infra-sample-domain-job-6l7zh status is Running
status on iteration 7 of 20
pod wcsitesinfra-create-fmw-infra-sample-domain-job-6l7zh status is Running
status on iteration 8 of 20
pod wcsitesinfra-create-fmw-infra-sample-domain-job-6l7zh status is Running
status on iteration 9 of 20
pod wcsitesinfra-create-fmw-infra-sample-domain-job-6l7zh status is Running
status on iteration 10 of 20
pod wcsitesinfra-create-fmw-infra-sample-domain-job-6l7zh status is Running
status on iteration 11 of 20
pod wcsitesinfra-create-fmw-infra-sample-domain-job-6l7zh status is Running
status on iteration 12 of 20
pod wcsitesinfra-create-fmw-infra-sample-domain-job-6l7zh status is Running
status on iteration 13 of 20
pod wcsitesinfra-create-fmw-infra-sample-domain-job-6l7zh status is Running
status on iteration 14 of 20
pod wcsitesinfra-create-fmw-infra-sample-domain-job-6l7zh status is Running
status on iteration 15 of 20
pod wcsitesinfra-create-fmw-infra-sample-domain-job-6l7zh status is Running
status on iteration 16 of 20
pod wcsitesinfra-create-fmw-infra-sample-domain-job-6l7zh status is Completed
    
Domain wcsitesinfra was created and will be started by the WebLogic Kubernetes Operator
    
The following files were generated:
kubernetes/samples/scripts/create-wcsites-domain/output/weblogic-domains/wcsitesinfra/create-domain-inputs.yaml
kubernetes/samples/scripts/create-wcsites-domain/output/weblogic-domains/wcsitesinfra/create-domain-job.yaml
kubernetes/samples/scripts/create-wcsites-domain/output/weblogic-domains/wcsitesinfra/domain.yaml
    
Completed   
</code></pre></li><li><p>To monitor the above domain creation logs:</p><pre><code class=language-bash>$ kubectl get pods -n wcsites-ns |grep wcsitesinfra-create
     
wcsitesinfra-create-fmw-infra-sample-domain-job-6l7zh   1/1     Running   0          6s
</code></pre><pre><code class=language-bash>$ kubectl get pods -n wcsites-ns | grep wcsitesinfra-create | awk '{print $1}' | xargs kubectl -n wcsites-ns logs -f 
</code></pre><p>SAMPLE OUTPUT:</p><pre><code>The domain will be created using the script /u01/weblogic/createSitesDomain.sh
Install Automation -&gt; Starting automation script
    [mkdir] Created dir: /u01/wcs-wls-docker-install/work
    [echo] [3/14/20 7:54 AM] Work Directory=/u01/wcs-wls-docker-install/work
    [echo] [3/14/20 7:54 AM] DB URL: jdbc:oracle:thin:@
    [echo] [3/14/20 7:54 AM] Info -&gt; The script.db.connectstring has been set.
    [echo] [3/14/20 7:54 AM] Info.setDBConnectStringPropertey -&gt; setting blr00bbf.in.oracle.com:1521/RCUDBS
    [echo] [3/14/20 7:54 AM] Validation -&gt; Checking if full path to JAVA executable is correctly specified
    [exec] java version &quot;1.8.0_241&quot;
    [exec] Java(TM) SE Runtime Environment (build 1.8.0_241-b07)
    [exec] Java HotSpot(TM) 64-Bit Server VM (build 25.241-b07, mixed mode)
    [echo] [3/14/20 7:54 AM] Validation -&gt; Checking database connection
    [echo] [3/14/20 7:54 AM] dbUrl-----------------: jdbc:oracle:thin:@blr00bbf.in.oracle.com:1521/RCUDBS
    [echo] [3/14/20 7:54 AM] Database Connection --&gt; Success!
    [echo] [3/14/20 7:54 AM] 1st phase: WebCenter Sites installation started...
    [copy] Copying 1 file to /u01/wcs-wls-docker-install/work
    [copy] Copying /u01/wcs-wls-docker-install/rcu.rsp to /u01/wcs-wls-docker-install/work/rcu.rsp
    [echo] [3/14/20 7:54 AM] 1st phase: WebCenter Sites installation completed
    [echo] [3/14/20 7:54 AM] 2nd phase: WebCenter Sites RCU configuration started...
    [echo] [3/14/20 7:54 AM] Installation -&gt; Repository Creation Utility - creates schema
    [echo] [3/14/20 7:54 AM] connectString-----------------: blr00bbf.in.oracle.com:1521/RCUDBS
[replace] Replaced 1 occurrences in 1 files.
[replace] Replaced 1 occurrences in 1 files.
[replace] Replaced 1 occurrences in 1 files.
[replace] Replaced 1 occurrences in 1 files.
[replace] Replaced 1 occurrences in 1 files.
    [echo] [3/14/20 7:54 AM] Create schema using command: /u01/oracle/oracle_common/bin/rcu -silent -responseFile /u01/wcs-wls-docker-install/work/rcu.rsp -f &lt; /u01/wcs-wls-docker-install/work/rcuPasswords8852085298596415722.txt &gt;/u01/wcs-wls-docker-install/work/rcu_output.log
    [echo] [3/14/20 7:54 AM] RCU Create Schema -&gt; Please wait ... may take several minutes
    [echo] [3/14/20 8:00 AM]
    [echo]     RCU Logfile: /u01/wcs-wls-docker-install/work/rcu/RCU2020-03-14_07-54_2112542638/logs/rcu.log
    [echo] Processing command line ....
    [echo] Repository Creation Utility - Checking Prerequisites
    [echo] Checking Global Prerequisites
    [echo] Repository Creation Utility - Checking Prerequisites
    [echo] Checking Component Prerequisites
    [echo] Repository Creation Utility - Creating Tablespaces
    [echo] Validating and Creating Tablespaces
    [echo] Create tablespaces in the repository database
    [echo] Repository Creation Utility - Create
    [echo] Repository Create in progress.
    [echo] Executing pre create operations
    [echo]         Percent Complete: 20
    [echo]         Percent Complete: 20
    [echo]         Percent Complete: 22
    [echo]         Percent Complete: 24
    [echo]         Percent Complete: 26
    [echo]         Percent Complete: 26
    [echo]         Percent Complete: 28
    [echo]         Percent Complete: 28
    [echo] Creating Common Infrastructure Services(STB)
    [echo]         Percent Complete: 36
    [echo]         Percent Complete: 36
    [echo]         Percent Complete: 46
    [echo]         Percent Complete: 46
    [echo]         Percent Complete: 46
    [echo] Creating Audit Services Append(IAU_APPEND)
    [echo]         Percent Complete: 54
    [echo]         Percent Complete: 54
    [echo]         Percent Complete: 64
    [echo]         Percent Complete: 64
    [echo]         Percent Complete: 64
    [echo] Creating Audit Services Viewer(IAU_VIEWER)
    [echo]         Percent Complete: 72
    [echo]         Percent Complete: 72
    [echo]         Percent Complete: 72
    [echo]         Percent Complete: 73
    [echo]         Percent Complete: 73
    [echo]         Percent Complete: 74
    [echo]         Percent Complete: 74
    [echo]         Percent Complete: 74
    [echo] Creating Weblogic Services(WLS)
    [echo]         Percent Complete: 79
    [echo]         Percent Complete: 79
    [echo]         Percent Complete: 83
    [echo]         Percent Complete: 83
    [echo]         Percent Complete: 92
    [echo]         Percent Complete: 99
    [echo]         Percent Complete: 99
    [echo] Creating Audit Services(IAU)
    [echo]         Percent Complete: 100
    [echo] Creating Oracle Platform Security Services(OPSS)
    [echo] Creating WebCenter Sites(WCSITES)
    [echo] Executing post create operations
    [echo] Repository Creation Utility: Create - Completion Summary
    [echo] Database details:
    [echo] -----------------------------
    [echo] Host Name                                    : blr00bbf.in.oracle.com
    [echo] Port                                         : 1521
    [echo] Service Name                                 : RCUDBS
    [echo] Connected As                                 : sys
    [echo] Prefix for (prefixable) Schema Owners        : WCS140
    [echo] RCU Logfile                                  : /u01/wcs-wls-docker-install/work/rcu/RCU2020-03-14_07-54_2112542638/logs/rcu.log
    [echo] Component schemas created:
    [echo] -----------------------------
    [echo] Component                                    Status         Logfile
    [echo] Common Infrastructure Services               Success        /u01/wcs-wls-docker-install/work/rcu/RCU2020-03-14_07-54_2112542638/logs/stb.log
    [echo] Oracle Platform Security Services            Success        /u01/wcs-wls-docker-install/work/rcu/RCU2020-03-14_07-54_2112542638/logs/opss.log
    [echo] WebCenter Sites                              Success        /u01/wcs-wls-docker-install/work/rcu/RCU2020-03-14_07-54_2112542638/logs/wcsites.log
    [echo] Audit Services                               Success        /u01/wcs-wls-docker-install/work/rcu/RCU2020-03-14_07-54_2112542638/logs/iau.log
    [echo] Audit Services Append                        Success        /u01/wcs-wls-docker-install/work/rcu/RCU2020-03-14_07-54_2112542638/logs/iau_append.log
    [echo] Audit Services Viewer                        Success        /u01/wcs-wls-docker-install/work/rcu/RCU2020-03-14_07-54_2112542638/logs/iau_viewer.log
    [echo] WebLogic Services                            Success        /u01/wcs-wls-docker-install/work/rcu/RCU2020-03-14_07-54_2112542638/logs/wls.log
    [echo] Repository Creation Utility - Create : Operation Completed
    [echo] [3/14/20 8:00 AM] Successfully created schemas
    [echo] [3/14/20 8:00 AM] 2nd phase: WebCenter Sites RCU configuration completed successfully.
    [echo] [3/14/20 8:00 AM] Oracle WebCenter Sites Installation complete. You can connect to the WebCenter Sites instance at http://10.244.0.252:7002/sites/
    
Sites RCU Phase completed successfull!!!
    
    
    
Sites Installation completed in 366 seconds.
---------------------------------------------------------
    
The domain will be created using the script /u01/weblogic/create-domain-script.sh
wlst.sh -skipWLSModuleScanning /u01/weblogic/createSitesDomain.py -oh /u01/oracle -jh /u01/jdk -parent /u01/oracle/user_projects/domains/wcsitesinfra/.. -name wcsitesinfra -user weblogic -password Welcome1 -rcuDb blr00bbf.in.oracle.com:1521/RCUDBS -rcuPrefix WCS140 -rcuSchemaPwd Welcome1 -adminListenPort 7001 -adminName adminserver -managedNameBase wcsites_server -managedServerPort 8001 -prodMode true -managedServerCount 3 -clusterName wcsites_cluster -exposeAdminT3Channel false -t3ChannelPublicAddress 10.123.152.96 -t3ChannelPort 30012 -domainType wcsites -machineName wcsites_machine
    
Initializing WebLogic Scripting Tool (WLST) ...
    
Welcome to WebLogic Server Administration Scripting Shell
    
Type help() for help on available commands
    
Creating Admin Server...
Creating cluster...
Creating Node Managers...
managed server name is wcsites_server1
managed server name is wcsites_server2
managed server name is wcsites_server3
['wcsites_server1', 'wcsites_server2', 'wcsites_server3']
Will create Base domain at /u01/oracle/user_projects/domains/wcsitesinfra
Writing base domain...
Base domain created at /u01/oracle/user_projects/domains/wcsitesinfra
Extending domain at /u01/oracle/user_projects/domains/wcsitesinfra
Database  blr00bbf.in.oracle.com:1521/RCUDBS
ExposeAdminT3Channel false with 10.123.152.96:30012
Applying JRF templates...
Extension Templates added
Applying WCSITES templates...
Extension Templates added
Configuring the Service Table DataSource...
fmwDb...jdbc:oracle:thin:@blr00bbf.in.oracle.com:1521/RCUDBS
Set user...WCS140_OPSS
Set user...WCS140_IAU_APPEND
Set user...WCS140_IAU_VIEWER
Set user...WCS140_STB
Set user...WCS140_WCSITES
Getting Database Defaults...
Targeting Server Groups...
Targeting Server Groups...
Set CoherenceClusterSystemResource to defaultCoherenceCluster for server:wcsites_server1
Set CoherenceClusterSystemResource to defaultCoherenceCluster for server:wcsites_server2
Set CoherenceClusterSystemResource to defaultCoherenceCluster for server:wcsites_server3
Targeting Cluster ...
Set CoherenceClusterSystemResource to defaultCoherenceCluster for cluster:wcsites_cluster
Set WLS clusters as target of defaultCoherenceCluster:[wcsites_cluster]
Preparing to update domain...
Mar 14, 2020 8:01:52 AM oracle.security.jps.az.internal.runtime.policy.AbstractPolicyImpl initializeReadStore
INFO: Property for read store in parallel: oracle.security.jps.az.runtime.readstore.threads = null
Domain updated successfully
Copying /u01/weblogic/server-config-update.sh to PV /u01/oracle/user_projects/domains/wcsitesinfra
Copying /u01/weblogic/unicast.py to PV /u01/oracle/user_projects/domains/wcsitesinfra
replacing tokens in /u01/oracle/user_projects/domains/wcsitesinfra/server-config-update.sh
Successfully Completed
</code></pre></li></ol><h4 id=initialize-the-webcenter-sites-domain>Initialize the WebCenter Sites Domain</h4><p>To start the domain, apply the above <code>domain.yaml</code>:</p><pre><code>```bash
$ kubectl apply -f kubernetes/samples/scripts/create-wcsites-domain/output/weblogic-domains/wcsitesinfra/domain.yaml
domain.weblogic.oracle/wcsitesinfra created
```
</code></pre><h4 id=verify-the-webcenter-sites-domain>Verify the WebCenter Sites Domain</h4><p>Verify that the domain and servers pods and services are created and in the READY state:</p><p>Sample run below:</p><pre><code class=language-bash>-bash-4.2$ kubectl get pods -n wcsites-ns -w
NAME                                                    READY   STATUS      	RESTARTS	AGE
wcsitesinfra-create-fmw-infra-sample-domain-job-6l7zh   0/1     Completed   	0          	15m
wcsitesinfra-introspect-domain-job-7tvdt                1/1     Running     	0          	15s
wcsitesinfra-introspect-domain-job-7tvdt   				0/1   	Completed   	0     	   	25s
wcsitesinfra-introspect-domain-job-7tvdt   				0/1   	Terminating 	0     		5s
wcsitesinfra-adminserver  								0/1   	Pending   		0     		0s
wcsitesinfra-adminserver  								0/1   	Init:0/1  		0     		0s
wcsitesinfra-adminserver  								0/1   	PodInitializing 0     		12s
wcsitesinfra-adminserver  								0/1   	Running   		0     		13s
wcsitesinfra-adminserver  								1/1   	Running   		0     		108s
wcsitesinfra-wcsites-server1   							0/1   	Pending   		0     		0s
wcsitesinfra-wcsites-server1   							0/1   	Init:0/1  		0     		1s
wcsitesinfra-wcsites-server1   							0/1   	PodInitializing 0     		13s
wcsitesinfra-wcsites-server1   							0/1   	Running   		0     		14s
wcsitesinfra-wcsites-server1   							1/1   	Running   		0     		96s
</code></pre><pre><code class=language-bash>-bash-4.2$ kubectl get all -n wcsites-ns
NAME                                                        READY   STATUS      RESTARTS   AGE
pod/wcsitesinfra-adminserver                                1/1     Running     0          7m5s
pod/wcsitesinfra-create-fmw-infra-sample-domain-job-6l7zh   0/1     Completed   0          22m
pod/wcsitesinfra-wcsites-server1                            1/1     Running     0          5m17s

NAME                                           TYPE        CLUSTER-IP     EXTERNAL-IP   PORT(S)    AGE
service/wcsitesinfra-adminserver               ClusterIP   None           &lt;none&gt;        7001/TCP   7m5s
service/wcsitesinfra-cluster-wcsites-cluster   ClusterIP   10.109.210.3   &lt;none&gt;        8001/TCP   5m17s
service/wcsitesinfra-wcsites-server1           ClusterIP   None           &lt;none&gt;        8001/TCP   5m17s

NAME                                                        COMPLETIONS   DURATION   AGE
job.batch/wcsitesinfra-create-fmw-infra-sample-domain-job   1/1           7m40s      22m
</code></pre><p>To see the Admin and Managed Servers logs, you can check the pod logs:</p><pre><code class=language-bash>$ kubectl logs -f wcsitesinfra-adminserver -n wcsites-ns
</code></pre><pre><code class=language-bash>$ kubectl exec -it wcsitesinfra-adminserver  -n wcsites-ns -- /bin/bash
</code></pre><pre><code class=language-bash>$ kubectl logs -f wcsitesinfra-wcsites-server1 -n wcsites-ns
</code></pre><pre><code class=language-bash>$ kubectl exec -it wcsitesinfra-wcsites-server1  -n wcsites-ns -- /bin/bash
</code></pre><h5 id=verify-the-pods>Verify the Pods</h5><p>Use the following command to see the pods running the servers:</p><pre><code>$ kubectl get pods -n NAMESPACE
</code></pre><p>Here is an example of the output of this command:</p><pre><code>-bash-4.2$ kubectl get pods -n wcsites-ns
NAME                                                    READY   STATUS      RESTARTS   AGE
wcsitesinfra-adminserver                                1/1     Running     0          56m
wcsitesinfra-create-fmw-infra-sample-domain-job-rq4xv   0/1     Completed   0          65m
wcsitesinfra-wcsites-server1                            1/1     Running     0          41m
wcsitesinfra-wcsites-server2                            1/1     Running     0          41m
</code></pre><h5 id=verify-the-services>Verify the Services</h5><p>Use the following command to see the services for the domain:</p><pre><code>$ kubectl get services -n NAMESPACE
</code></pre><p>Here is an example of the output of this command:</p><pre><code>-bash-4.2$ kubectl get services -n wcsites-ns
NAME                                                    READY   STATUS      RESTARTS   AGE
wcsitesinfra-adminserver                                1/1     Running     0          7m38s
wcsitesinfra-create-fmw-infra-sample-domain-job-6l7zh   0/1     Completed   0          23m
wcsitesinfra-wcsites-server1                            1/1     Running     0          5m50s
</code></pre><h4 id=expose-webcenter-sites-services>Expose WebCenter Sites Services</h4><p>Below are the default values for exposing services required for all the WebCenter Sites Managed Servers.
Reset them if any values are modified.</p><p>Details on <code>kubernetes/samples/scripts/create-wcsites-domain/utils/wcs-services.yaml</code>:</p><ul><li>name: wcsitesinfra-wcsites-server1-mcp</li><li>namespace: wcsites-ns</li><li>weblogic.domainUID: wcsitesinfra</li><li>weblogic.serverName: wcsites_server1</li></ul><p>Execute the below command for exposing the services: (If domain is configured for more than 3 Managed Servers then add the service yaml for additional servers.)</p><pre><code class=language-bash>$ kubectl apply -f kubernetes/samples/scripts/create-wcsites-domain/utils/wcs-services.yaml
service/wcsitesinfra-wcsites-server1-np created
service/wcsitesinfra-wcsites-server1-svc created
service/wcsitesinfra-wcsites-server2-svc created
service/wcsitesinfra-wcsites-server3-svc created
</code></pre><p>To verify the services created, here is an example of the output of this command:</p><pre><code>-bash-4.2$ kubectl get services -n wcsites-ns
NAME                                   TYPE        CLUSTER-IP       EXTERNAL-IP   PORT(S)                                                                                               AGE
wcsitesinfra-adminserver               ClusterIP   None             &lt;none&gt;        7001/TCP                                                                                              11m
wcsitesinfra-cluster-wcsites-cluster   ClusterIP   10.109.210.3     &lt;none&gt;        8001/TCP                                                                                              9m14s
wcsitesinfra-wcsites-server1           ClusterIP   None             &lt;none&gt;        8001/TCP                                                                                              9m14s
wcsitesinfra-wcsites-server1-np        NodePort    10.105.167.205   &lt;none&gt;        8001:30155/TCP                                                                                        2m47s
wcsitesinfra-wcsites-server1-svc       ClusterIP   None             &lt;none&gt;        50000/TCP,50001/TCP,50002/TCP,50003/TCP,50004/TCP,50005/TCP,50006/TCP,50007/TCP,50008/TCP,50009/TCP   2m47s
wcsitesinfra-wcsites-server2-svc       ClusterIP   None             &lt;none&gt;        50000/TCP,50001/TCP,50002/TCP,50003/TCP,50004/TCP,50005/TCP,50006/TCP,50007/TCP,50008/TCP,50009/TCP   2m47s
wcsitesinfra-wcsites-server3-svc       ClusterIP   None             &lt;none&gt;        50000/TCP,50001/TCP,50002/TCP,50003/TCP,50004/TCP,50005/TCP,50006/TCP,50007/TCP,50008/TCP,50009/TCP   2m47s
</code></pre><h4 id=load-balance-with-an-ingress-controller-or-a-web-server>Load Balance With an Ingress Controller or A Web Server</h4><p>You can choose a load balancer provider for your WebLogic domains running in a Kubernetes cluster.
Please refer to the <a href=https://github.com/oracle/weblogic-kubernetes-operator/blob/master/kubernetes/samples/charts/README.md>WebLogic Kubernetes Operator Load Balancer Samples</a> for information about the current capabilities and setup instructions for each of the supported load balancers.</p><p>For information on how to set up Loadbalancer for setting up WebCenter Sites domain on K8S:</p><p>For Traefik, see <a href=/ghpages-test/wcsites-domains/manage-wcsites-domains/loadbalancer-traefik-setup-for-wcsites-domain-setup-on-k8s/>Setting Up Loadbalancer Traefik for the WebCenter Sites Domain on K8S</a></p><p>For Voyager, see <a href=/ghpages-test/wcsites-domains/manage-wcsites-domains/loadbalancer-voyager-setup-for-wcsites-domain-setup-on-k8s/>Setting Up Loadbalancer Voyager for the WebCenter Sites Domain on K8S</a></p><h4 id=configure-webcenter-sites>Configure WebCenter Sites</h4><ol><li><p>Configure WebCenter Sites by hitting url <code>http://${LOADBALANCER-HOSTNAME}:${LOADBALANCER-PORT}/sites/sitesconfigsetup</code></p><p>When installing, select sample sites to be installed and enter the required passwords. Do not change the sites-config location. If you change the location, installation will fail.</p></li><li><p>After the configuration is complete, edit the domain, and restart the Managed Server.</p></li></ol><p>To stop Managed Servers:</p><pre><code class=language-bash>$ kubectl patch domain wcsitesinfra -n wcsites-ns --type='json' -p='[{&quot;op&quot;: &quot;replace&quot;, &quot;path&quot;: &quot;/spec/clusters/0/replicas&quot;, &quot;value&quot;: 0 }]'
</code></pre><p>To start all configured Managed Servers:</p><pre><code class=language-bash>$ kubectl patch domain wcsitesinfra -n wcsites-ns --type='json' -p='[{&quot;op&quot;: &quot;replace&quot;, &quot;path&quot;: &quot;/spec/clusters/0/replicas&quot;, &quot;value&quot;: 3 }]' 
</code></pre><ol><li>Wait till the Managed Server pod is killed and then restart it. Monitor with below command:
<code>bash
-bash-4.2$ kubectl get pods -n wcsites-ns -w
NAME READY STATUS RESTARTS AGE
wcsitesinfra-adminserver 1/1 Running 0 111m
wcsitesinfra-create-fmw-infra-sample-domain-job-6l7zh 0/1 Completed 0 126m
wcsitesinfra-wcsites-server1 1/1 Running 0 3m7s
wcsitesinfra-wcsites-server2 1/1 Running 0 3m7s
wcsitesinfra-wcsites-server3 1/1 Running 0 3m7s</code></li></ol><footer class=footline></footer></div></div><div id=navigation><a class="nav nav-prev" href=/ghpages-test/wcsites-domains/prepare-your-environment/ title="Prepare your environment"><i class="fa fa-chevron-left"></i></a><a class="nav nav-next" href=/ghpages-test/wcsites-domains/manage-wcsites-domains/ title="Manage WebCenter Sites domains" style=margin-right:0><i class="fa fa-chevron-right"></i></a></div></section><div style=left:-1000px;overflow:scroll;position:absolute;top:-1000px;border:none;box-sizing:content-box;height:200px;margin:0;padding:0;width:200px><div style=border:none;box-sizing:content-box;height:200px;margin:0;padding:0;width:200px></div></div><script src=/ghpages-test/js/clipboard.min.js?1584947815></script><script src=/ghpages-test/js/perfect-scrollbar.min.js?1584947815></script><script src=/ghpages-test/js/perfect-scrollbar.jquery.min.js?1584947815></script><script src=/ghpages-test/js/jquery.sticky.js?1584947815></script><script src=/ghpages-test/js/featherlight.min.js?1584947815></script><script src=/ghpages-test/js/highlight.pack.js?1584947815></script><script>hljs.initHighlightingOnLoad();</script><script src=/ghpages-test/js/modernizr.custom-3.6.0.js?1584947815></script><script src=/ghpages-test/js/learn.js?1584947815></script><script src=/ghpages-test/js/hugo-learn.js?1584947815></script><link href=/ghpages-test/mermaid/mermaid.css?1584947815 rel=stylesheet><script src=/ghpages-test/mermaid/mermaid.js?1584947815></script><script>mermaid.initialize({startOnLoad:true});</script></body></html>