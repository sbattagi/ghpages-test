<!doctype html><html lang=en class="js csstransforms3d"><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=generator content="Hugo 0.53"><meta name=description content="Use the WebLogic Monitoring Exporter to monitor a WebCenter Sites instance using Prometheus and Grafana."><link rel=icon href=/ghpages-test/images/favicon.png type=image/png><title>e. Monitor a WebCenter Sites domain :: Oracle Fusion Middleware on Kubernetes</title><link href=/ghpages-test/css/nucleus.css?1584947815 rel=stylesheet><link href=/ghpages-test/css/fontawesome-all.min.css?1584947815 rel=stylesheet><link href=/ghpages-test/css/hybrid.css?1584947815 rel=stylesheet><link href=/ghpages-test/css/featherlight.min.css?1584947815 rel=stylesheet><link href=/ghpages-test/css/perfect-scrollbar.min.css?1584947815 rel=stylesheet><link href=/ghpages-test/css/auto-complete.css?1584947815 rel=stylesheet><link href=/ghpages-test/css/atom-one-dark-reasonable.css?1584947815 rel=stylesheet><link href=/ghpages-test/css/theme.css?1584947815 rel=stylesheet><link href=/ghpages-test/css/hugo-theme.css?1584947815 rel=stylesheet><script src=/ghpages-test/js/jquery-3.3.1.min.js?1584947815></script><style>:root #header+#content>#left>#rlblock_left{display:none!important}</style></head><body data-url=/ghpages-test/wcsites-domains/manage-wcsites-domains/weblogic-monitoring-exporter-setup/><nav id=sidebar><div id=header-wrapper><div id=header><a id=logo href=/ghpages-test/><img src=/ghpages-test//images/fmw_12c_12_2_1_4_0-logo.png height=100><br><b>Oracle Fusion Middleware on Kubernetes</b></a></div><div class=searchbox><label for=search-by><i class="fas fa-search"></i></label><input data-search-input id=search-by type=search placeholder=Search...>
<span data-search-clear><i class="fas fa-times"></i></span></div><script type=text/javascript src=/ghpages-test/js/lunr.min.js?1584947815></script><script type=text/javascript src=/ghpages-test/js/auto-complete.js?1584947815></script><script type=text/javascript>var baseurl="\/ghpages-test\/";</script><script type=text/javascript src=/ghpages-test/js/search.js?1584947815></script></div><div class=highlightable><ul class=topics><li><a class=padding href=/fmw-kubernetes/>Home</a></li><li data-nav-id=/ghpages-test/soa-domains/ title="Oracle SOA Suite" class=dd-item><a href=/ghpages-test/soa-domains/>Oracle SOA Suite</a><ul><li data-nav-id=/ghpages-test/soa-domains/prerequisites/ title=Prerequisites class=dd-item><a href=/ghpages-test/soa-domains/prerequisites/><b>1. </b>Prerequisites</a></li><li data-nav-id=/ghpages-test/soa-domains/prepare-your-environment/ title="Prepare your environment" class=dd-item><a href=/ghpages-test/soa-domains/prepare-your-environment/><b>2. </b>Prepare your environment</a></li><li data-nav-id=/ghpages-test/soa-domains/create-soa-domains/ title="Create SOA domains" class=dd-item><a href=/ghpages-test/soa-domains/create-soa-domains/><b>3. </b>Create SOA domains</a></li><li data-nav-id=/ghpages-test/soa-domains/manage-soa-domains/ title="Manage SOA Domains" class=dd-item><a href=/ghpages-test/soa-domains/manage-soa-domains/><b>4. </b>Manage SOA Domains</a><ul><li data-nav-id=/ghpages-test/soa-domains/manage-soa-domains/configuring-load-balancer/ title="Configuring a load balancer for SOA Domains" class=dd-item><a href=/ghpages-test/soa-domains/manage-soa-domains/configuring-load-balancer/><b>1. </b>Configuring a load balancer for SOA Domains</a></li><li data-nav-id=/ghpages-test/soa-domains/manage-soa-domains/monitoring-soa-domains/ title="Monitoring a SOA domain" class=dd-item><a href=/ghpages-test/soa-domains/manage-soa-domains/monitoring-soa-domains/><b>2. </b>Monitoring a SOA domain</a></li><li data-nav-id=/ghpages-test/soa-domains/manage-soa-domains/delete-domain-home/ title="Delete the SOA domain home" class=dd-item><a href=/ghpages-test/soa-domains/manage-soa-domains/delete-domain-home/><b>3. </b>Delete the SOA domain home</a></li><li data-nav-id=/ghpages-test/soa-domains/manage-soa-domains/supportjdev/ title="Deploying SOA Composites from Oracle JDeveloper" class=dd-item><a href=/ghpages-test/soa-domains/manage-soa-domains/supportjdev/><b>4. </b>Deploying SOA Composites from Oracle JDeveloper</a></li><li data-nav-id=/ghpages-test/soa-domains/manage-soa-domains/enablingt3/ title="Expose T3 protocol for Managed Servers" class=dd-item><a href=/ghpages-test/soa-domains/manage-soa-domains/enablingt3/><b>5. </b>Expose T3 protocol for Managed Servers</a></li><li data-nav-id=/ghpages-test/soa-domains/manage-soa-domains/persisting-soa-adapters-customizations/ title="Persisting SOA Adapters Customizations" class=dd-item><a href=/ghpages-test/soa-domains/manage-soa-domains/persisting-soa-adapters-customizations/><b>6. </b>Persisting SOA Adapters Customizations</a></li></ul></li><li data-nav-id=/ghpages-test/soa-domains/patch-soa-domains/ title="Patch SOA domains" class=dd-item><a href=/ghpages-test/soa-domains/patch-soa-domains/><b>5. </b>Patch SOA domains</a></li><li data-nav-id=/ghpages-test/soa-domains/known-issues/ title="Known Issues" class=dd-item><a href=/ghpages-test/soa-domains/known-issues/><b>6. </b>Known Issues</a></li><li data-nav-id=/ghpages-test/soa-domains/release-notes/ title="Release Notes" class=dd-item><a href=/ghpages-test/soa-domains/release-notes/>Release Notes</a></li></ul></li><li data-nav-id=/ghpages-test/wcsites-domains/ title="Oracle WebCenter Sites" class="dd-item 
        parent"><a href=/ghpages-test/wcsites-domains/>Oracle WebCenter Sites</a><ul><li data-nav-id=/ghpages-test/wcsites-domains/pre-requisites/ title=Pre-requisites class=dd-item><a href=/ghpages-test/wcsites-domains/pre-requisites/><b>1. </b>Pre-requisites</a></li><li data-nav-id=/ghpages-test/wcsites-domains/prepare-your-environment/ title="Prepare your environment" class=dd-item><a href=/ghpages-test/wcsites-domains/prepare-your-environment/><b>2. </b>Prepare your environment</a></li><li data-nav-id=/ghpages-test/wcsites-domains/create-wcsites-domains/ title="Create WebCenter Sites domains" class=dd-item><a href=/ghpages-test/wcsites-domains/create-wcsites-domains/><b>3. </b>Create WebCenter Sites domains</a></li><li data-nav-id=/ghpages-test/wcsites-domains/manage-wcsites-domains/ title="Manage WebCenter Sites domains" class="dd-item 
        parent"><a href=/ghpages-test/wcsites-domains/manage-wcsites-domains/><b>4. </b>Manage WebCenter Sites domains</a><ul><li data-nav-id=/ghpages-test/wcsites-domains/manage-wcsites-domains/loadbalancer-traefik-setup-for-wcsites-domain-setup-on-k8s/ title="a. Using Traefik Loadbalancer" class=dd-item><a href=/ghpages-test/wcsites-domains/manage-wcsites-domains/loadbalancer-traefik-setup-for-wcsites-domain-setup-on-k8s/>a. Using Traefik Loadbalancer</a></li><li data-nav-id=/ghpages-test/wcsites-domains/manage-wcsites-domains/loadbalancer-voyager-setup-for-wcsites-domain-setup-on-k8s/ title="b. Using Voyager Loadbalancer" class=dd-item><a href=/ghpages-test/wcsites-domains/manage-wcsites-domains/loadbalancer-voyager-setup-for-wcsites-domain-setup-on-k8s/>b. Using Voyager Loadbalancer</a></li><li data-nav-id=/ghpages-test/wcsites-domains/manage-wcsites-domains/elasticsearch-integration-with-wls-operator-wls-server-logs/ title="c. ELK Integration for Logs" class=dd-item><a href=/ghpages-test/wcsites-domains/manage-wcsites-domains/elasticsearch-integration-with-wls-operator-wls-server-logs/>c. ELK Integration for Logs</a></li><li data-nav-id=/ghpages-test/wcsites-domains/manage-wcsites-domains/weblogic-logging-exporter-setup/ title="d. Publish logs to Elasticsearch" class=dd-item><a href=/ghpages-test/wcsites-domains/manage-wcsites-domains/weblogic-logging-exporter-setup/>d. Publish logs to Elasticsearch</a></li><li data-nav-id=/ghpages-test/wcsites-domains/manage-wcsites-domains/weblogic-monitoring-exporter-setup/ title="e. Monitor a WebCenter Sites domain" class="dd-item active"><a href=/ghpages-test/wcsites-domains/manage-wcsites-domains/weblogic-monitoring-exporter-setup/>e. Monitor a WebCenter Sites domain</a></li></ul></li><li data-nav-id=/ghpages-test/wcsites-domains/known-issues/ title="Known Issues in WCSites" class=dd-item><a href=/ghpages-test/wcsites-domains/known-issues/><b>6. </b>Known Issues in WCSites</a></li><li data-nav-id=/ghpages-test/wcsites-domains/release-notes/ title="Release Notes" class=dd-item><a href=/ghpages-test/wcsites-domains/release-notes/>Release Notes</a></li></ul></li></ul><section id=footer><p>Created with <i class="fas fa-heart"></i>from <a href=https://www.oracle.com>Oracle</a></p><p>&nbsp;</p><p><a href=https://github.com/oracle/fmw-kubernetes><i class="fab fa-github"></i>GitHub repo</a></p><p><a href=https://weblogic-slack-inviter.herokuapp.com/><i class="fab fa-slack"></i>Public Slack #</a></p></section></div></nav><section id=body><div id=overlay></div><div class="padding highlightable"><div><div id=top-bar><div id=breadcrumbs itemscope itemtype=http://data-vocabulary.org/Breadcrumb><span id=sidebar-toggle-span><a href=# id=sidebar-toggle data-sidebar-toggle><i class="fas fa-bars"></i></a></span><span id=toc-menu><i class="fas fa-list-alt"></i></span><span class=links><a href=/ghpages-test/>Oracle Fusion Middleware on Kubernetes</a> > <a href=/ghpages-test/wcsites-domains/>Oracle WebCenter Sites</a> > <a href=/ghpages-test/wcsites-domains/manage-wcsites-domains/>Manage WebCenter Sites domains</a> > e. Monitor a WebCenter Sites domain</span></div><div class=progress><div class=wrapper><nav id=TableOfContents><ul><li><ul><li><ul><li><a href=#prerequisites>Prerequisites</a><ul><li><a href=#clone-the-kube-prometheus-project>Clone the kube-prometheus project</a></li><li><a href=#label-the-nodes>Label the nodes</a></li><li><a href=#create-prometheus-and-grafana-resources>Create Prometheus and Grafana resources</a></li><li><a href=#provide-external-access>Provide external access</a></li></ul></li></ul></li><li><a href=#set-up-the-weblogic-monitoring-exporter>Set Up the WebLogic Monitoring Exporter</a><ul><li><ul><li><a href=#generate-the-weblogic-monitoring-exporter-deployment-package>Generate the WebLogic Monitoring Exporter Deployment Package</a></li><li><a href=#copy-the-war-files-to-the-weblogic-domain-home>Copy the WAR Files to the WebLogic Domain Home</a></li><li><a href=#deploy-the-weblogic-monitoring-exporter>Deploy the WebLogic Monitoring Exporter</a></li><li><a href=#configure-prometheus-operator>Configure Prometheus Operator</a></li><li><a href=#add-rolebinding-and-role-for-the-weblogic-domain-namespace>Add <code>RoleBinding</code> and <code>Role</code> for the WebLogic Domain Namespace</a></li><li><a href=#deploy-the-service-monitor>Deploy the Service Monitor</a></li><li><a href=#enable-prometheus-to-discover-the-service>Enable Prometheus to Discover the Service</a></li><li><a href=#deploy-grafana-dashboard>Deploy Grafana Dashboard</a></li></ul></li></ul></li></ul></li></ul></nav></div></div></div></div><div id=head-tags></div><div id=body-inner><h1>e. Monitor a WebCenter Sites domain</h1><p>You can monitor a WebCenter Sites domain using Prometheus and Grafana by exporting the metrics from the domain instance using the
WebLogic Monitoring Exporter. This sample shows you how to set up the WebLogic Monitoring Exporter to push the data
to Prometheus.</p><h3 id=prerequisites>Prerequisites</h3><p>This document assumes that the Prometheus Operator is deployed on the Kubernetes cluster. If it is not already deployed, follow the steps below for deploying the Prometheus Operator.</p><h4 id=clone-the-kube-prometheus-project>Clone the kube-prometheus project</h4><pre><code class=language-bash>$ git clone https://github.com/coreos/kube-prometheus.git
</code></pre><h4 id=label-the-nodes>Label the nodes</h4><p>Kube-Prometheus requires all the exporter nodes to be labelled with <code>kubernetes.io/os=linux</code>. If a node is not labelled, then you must label it using the following command:</p><pre><code>$ kubectl label nodes --all kubernetes.io/os=linux
</code></pre><h4 id=create-prometheus-and-grafana-resources>Create Prometheus and Grafana resources</h4><p>Change to the <code>kube-prometheus</code> directory and execute the following commands to create the namespace and CRDs:</p><p><strong>NOTE</strong>: Wait for a minute for each command to process.</p><pre><code class=language-bash>$ cd kube-prometheus

$ kubectl create -f manifests/setup
$ until kubectl get servicemonitors --all-namespaces ; do date; sleep 1; echo &quot;&quot;; done
$ kubectl create -f manifests/
</code></pre><h4 id=provide-external-access>Provide external access</h4><p>To provide external access for Grafana, Prometheus, and Alertmanager, execute the commands below:</p><pre><code class=language-bash>$ kubectl patch svc grafana -n monitoring --type=json -p '[{&quot;op&quot;: &quot;replace&quot;, &quot;path&quot;: &quot;/spec/type&quot;, &quot;value&quot;: &quot;NodePort&quot; },{&quot;op&quot;: &quot;replace&quot;, &quot;path&quot;: &quot;/spec/ports/0/nodePort&quot;, &quot;value&quot;: 32100 }]'
$ kubectl patch svc prometheus-k8s -n monitoring --type=json -p '[{&quot;op&quot;: &quot;replace&quot;, &quot;path&quot;: &quot;/spec/type&quot;, &quot;value&quot;: &quot;NodePort&quot; },{&quot;op&quot;: &quot;replace&quot;, &quot;path&quot;: &quot;/spec/ports/0/nodePort&quot;, &quot;value&quot;: 32101 }]'
$ kubectl patch svc alertmanager-main -n monitoring --type=json -p '[{&quot;op&quot;: &quot;replace&quot;, &quot;path&quot;: &quot;/spec/type&quot;, &quot;value&quot;: &quot;NodePort&quot; },{&quot;op&quot;: &quot;replace&quot;, &quot;path&quot;: &quot;/spec/ports/0/nodePort&quot;, &quot;value&quot;: 32102 }]'
</code></pre><p><strong>NOTE</strong>:</p><ul><li><code>32100</code> is the external port for Grafana</li><li><code>32101</code> is the external port for Prometheus</li><li><code>32102</code> is the external port for Alertmanager</li></ul><hr><h2 id=set-up-the-weblogic-monitoring-exporter>Set Up the WebLogic Monitoring Exporter</h2><p>Set up the WebLogic Monitoring Exporter that will collect WebLogic Server metrics and monitor your WebCenter Sites domain.</p><h4 id=generate-the-weblogic-monitoring-exporter-deployment-package>Generate the WebLogic Monitoring Exporter Deployment Package</h4><p>Two packages are required as the listening ports are different for the Administration Server and Managed Servers.
One binary required for the Admin Server (<code>wls-exporter-as.war</code>) and one for Managed Cluster (<code>wls-exporter-ms.war</code>).
Set the required proxies and then run the script <code>getX.X.X.sh</code> to generate two binaries:</p><pre><code class=language-bash>$ cd kubernetes/samples/scripts/create-wcsites-domain/utils/weblogic-monitoring-exporter

$ sh get1.1.0.sh
</code></pre><p>Output:</p><pre><code>  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
100   607    0   607    0     0    357      0 --:--:--  0:00:01 --:--:--   357
100 2016k  100 2016k    0     0   398k      0  0:00:05  0:00:05 --:--:--  797k
-------------------wls-exporter-ms start-------------------
created /tmp/ci-GNysQzP1kv
Copying completed
/tmp/ci-GNysQzP1kv /kubernetes/2.4.0/scripts/create-wcsites-domain/utils/weblogic-monitoring-exporter
in temp dir
  adding: WEB-INF/weblogic.xml (deflated 66%)
  adding: config.yml (deflated 63%)
wls-exporter-ms.war is ready
-------------------wls-exporter-ms end-------------------
-------------------wls-exporter-as start-------------------
Copying completed
in temp dir
  adding: WEB-INF/weblogic.xml (deflated 66%)
  adding: config.yml (deflated 52%)
wls-exporter-as.war is ready
-------------------wls-exporter-as end-------------------
zip completed
kubernetes/2.4.0/scripts/create-wcsites-domain/utils/weblogic-monitoring-exporter
</code></pre><h4 id=copy-the-war-files-to-the-weblogic-domain-home>Copy the WAR Files to the WebLogic Domain Home</h4><p>Copy the <code>wls-exporter-as.war</code> and <code>wls-exporter-ms.war</code> files to the domain home directory in the Administration Server pod.</p><pre><code>$ kubectl cp wls-exporter-as.war wcsites-ns/wcsitesinfra-adminserver:/u01/oracle/user_projects/domains/wcsitesinfra/

$ kubectl cp wls-exporter-ms.war wcsites-ns/wcsitesinfra-adminserver:/u01/oracle/user_projects/domains/wcsitesinfra/
</code></pre><h4 id=deploy-the-weblogic-monitoring-exporter>Deploy the WebLogic Monitoring Exporter</h4><p>Follow these steps to deploy the package in the WebLogic Server instances:</p><ol><li><p>In the Administration Server and Managed Servers, deploy the WebLogic Monitoring Exporter (<code>wls-exporter-ms.war</code>) separately using the Oracle Enterprise Manager.</p><p><img src=images/wme-deploy.png alt=Wme-Deploy></p></li><li><p>Select the servers to which the Exporter WAR should be deployed:</p><p><img src=images/wme-deploy-target-server.png alt=Wme-Deploy-Target-Server></p></li><li><p>Set the application name. The application name must be different if it is deployed separately in the Administration Server and Managed Servers. Make sure the context-root for both the deployments is <code>wls-exporter</code>:</p><p><img src=images/wme-deploy-contextroot.png alt=Wme-Deploy-Contextroot></p></li><li><p>Click <strong>Install and start application</strong>.</p></li><li><p>Then deploy the WebLogic Monitoring Exporter application (<code>wls-exporter-ms.war</code>).</p></li><li><p>Activate the changes to start the application. If the application is started and the port is exposed,
then you can access the WebLogic Monitoring Exporter console using this URL: <code>http://&lt;server:port&gt;/wls-exporter</code>.</p><p><img src=images/wme-test-url.png alt=Wme-Test-Url></p></li><li><p>Repeat same steps for <code>wls-exporter-as.war</code>.</p></li></ol><h4 id=configure-prometheus-operator>Configure Prometheus Operator</h4><p>Prometheus enables you to collect metrics from the WebLogic Monitoring Exporter. The Prometheus Operator identifies the targets using service discovery. To get the WebLogic Monitoring Exporter end point discovered as a target, you must create a service monitor pointing to the service.</p><p>See the following sample service monitor deployment YAML configuration file located at</p><p><code>kubernetes/samples/scripts/create-wcsites-domain/utils/weblogic-monitoring-exporter/wls-exporter.yaml</code>.</p><p><code>ServiceMonitor</code> for wls-exporter:</p><pre><code>apiVersion: v1
kind: Secret
metadata:
  name: basic-auth
  namespace: monitoring
data:
  password: V2VsY29tZTE= # Welcome1 i.e.'WebLogic password'
  user: d2VibG9naWM= # weblogic  i.e. 'WebLogic username'
type: Opaque
---
apiVersion: monitoring.coreos.com/v1
kind: ServiceMonitor
metadata:
  name: wls-exporter-wcsitesinfra
  namespace: monitoring
  labels:
    k8s-app: wls-exporter
spec:
  namespaceSelector:
    matchNames:
    - wcsites-ns
  selector:
    matchLabels:
      weblogic.domainName: wcsitesinfra
  endpoints:
  - basicAuth:
      password:
        name: basic-auth
        key: password
      username:
        name: basic-auth
        key: user
    port: default
    relabelings:
      - action: labelmap
        regex: __meta_kubernetes_service_label_(.+)
    interval: 10s
    honorLabels: true
    path: /wls-exporter/metrics
</code></pre><p>The exporting of metrics from <code>wls-exporter</code> requires <code>basicAuth</code> so a Kubernetes <code>Secret</code> is created with the user name and password that are base64 encoded. This <code>Secret</code> will be used in the <code>ServiceMonitor</code> deployment.</p><p>When generating the base64 encoded strings for the user name and password, observe if a new line character is appended in the encoded string. This line character causes an authentication failure. To avoid a new line string, use the following example:</p><pre><code>$ echo -n &quot;Welcome1&quot; | base64
V2VsY29tZTE=
</code></pre><p>In the deployment YAML configuration for <code>wls-exporter</code> shown above, <code>weblogic.domainName: wcsitesinfra</code> is used as a label under <code>spec.selector.matchLabels</code>, so all the services will be selected for the service monitor. If you don&rsquo;t use this label, you should create separate service monitors for each server&ndash;if the server name is used as matching labels in <code>spec.selector.matchLabels</code>. Doing so will require you to relabel the configuration because Prometheus, by default, ignores the labels provided in the wls-exporter.</p><p>By default, Prometheus does not store all the labels provided by the target. In the service monitor deployment YAML configuration, you must mention the relabeling configuration (<code>spec.endpoints.relabelings</code>) so that certain labels provided by <code>weblogic-monitoring-exporter</code> (required for the Grafana dashboard) are stored in Prometheus. Do not delete the following section from the configuration YAML file:</p><pre><code>relabelings:
  - action: labelmap
    regex: __meta_kubernetes_service_label_(.+)
</code></pre><h4 id=add-rolebinding-and-role-for-the-weblogic-domain-namespace>Add <code>RoleBinding</code> and <code>Role</code> for the WebLogic Domain Namespace</h4><p>The
RoleBinding is required for Prometheus to access the endpoints provided by the WebLogic Monitoring Exporter. You need to add RoleBinding for the namespace under which the WebLogic Servers pods are running in the Kubernetes cluster. Edit the <code>kube-prometheus/manifests/prometheus-roleBindingSpecificNamespaces.yaml</code> file in the Prometheus Operator deployment manifests and add the <code>RoleBinding</code> for the namespace (<code>wcsites-ns</code>) similar to the following example:</p><pre><code>- apiVersion: rbac.authorization.k8s.io/v1
  kind: RoleBinding
  metadata:
    name: prometheus-k8s
    namespace: wcsites-ns
  roleRef:
    apiGroup: rbac.authorization.k8s.io
    kind: Role
    name: prometheus-k8s
  subjects:
  - kind: ServiceAccount
    name: prometheus-k8s
 namespace: monitoring
</code></pre><p>Similarly, add the <code>Role</code> for the namespace under which the WebLogic Servers pods are running in the Kubernetes cluster. Edit <code>kube-prometheus/manifests/prometheus-roleSpecificNamespaces.yaml</code> in the Prometheus Operator deployment manifests and add the <code>Role</code> for the namespace (<code>wcsites-ns</code>) similar to the following example:</p><pre><code>- apiVersion: rbac.authorization.k8s.io/v1
  kind: Role
  metadata:
    name: prometheus-k8s
    namespace: wcsites-ns
  rules:
  - apiGroups:
    - &quot;&quot;
    resources:
    - services
    - endpoints
    - pods
    verbs:
    - get
    - list
    - watch
</code></pre><p>Then apply <code>prometheus-roleBindingSpecificNamespaces.yaml</code> and <code>prometheus-roleSpecificNamespaces.yaml</code> for the <code>RoleBinding</code> and <code>Role</code> to take effect in the cluster.</p><pre><code>$ kubectl apply -f kube-prometheus/manifests/prometheus-roleBindingSpecificNamespaces.yaml

$ kubectl apply -f kube-prometheus/manifests/prometheus-roleSpecificNamespaces.yaml
</code></pre><h4 id=deploy-the-service-monitor>Deploy the Service Monitor</h4><p>To deploy the service monitor, use the above wls-exporter.yaml deployment YAML and run the following command:</p><pre><code>$ kubectl create -f kubernetes/samples/scripts/create-wcsites-domain/utils/weblogic-monitoring-exporter/wls-exporter.yaml
</code></pre><h4 id=enable-prometheus-to-discover-the-service>Enable Prometheus to Discover the Service</h4><p>After the deployment of the service monitor, Prometheus should be able to discover wls-exporter and export metrics.</p><p>You can access the Prometheus dashboard at <code>http://mycompany.com:32101/</code>.</p><p><img src=images/wme-service-discovery.png alt=Wme-Service-Discovery></p><h4 id=deploy-grafana-dashboard>Deploy Grafana Dashboard</h4><p>To view the domain metrics, deploy the Grafana dashboard provided in the <a href=https://github.com/oracle/weblogic-monitoring-exporter/tree/master/samples/kubernetes/end2end#monitoring-weblogic-server-with-the-grafana-dashboard>WebLogic Monitoring Exporter</a>.</p><p>You can access the Grafana dashboard at <code>http://mycompany.com:32100/</code>.</p><ol><li>Log in to Grafana dashboard with <code>admin/admin</code>.</li><li><p>Go to <strong>Settings</strong>, then select <strong>DataSources</strong>, and then <strong>Add Data Source</strong>.</p><p>HTTP URL: Prometheus URL <code>http://mycompany.com:32101/</code></p><p>Auth: Enable Basic Auth</p><p>Basic Auth Details: Weblogic credentials provided in step <a href=#configure-prometheus-operator>Configure Prometheus Operator</a></p><p><img src=images/wme-gp-add-datasource.png alt=Wme-GP-Add-Datasource></p></li><li><p>Download the <code>weblogic_dashboard.json</code> file from <a href=https://raw.githubusercontent.com/oracle/weblogic-monitoring-exporter/master/samples/kubernetes/end2end/dashboard/weblogic_dashboard.json>here</a>.</p></li><li><p>Edit the downloaded <code>json</code> and modify <code>[&quot;datasource&quot;: &quot;Prometheus&quot;,]</code> to <code>[&quot;datasource&quot;: &quot;Prometheus-1&quot;,]</code></p></li><li><p>Click <strong>Add</strong> and then <strong>Import</strong>. Paste the modified JSON in the Paste JSON block, and then load it.</p><p><img src=images/wme-gp-import-json.png alt=Wme-GP-Import-Json></p><p>This displays the WebLogic Server Dashboard.</p><p><img src=images/wme-gp-wls-dashboard.png alt=Wme-GP-WLS-Dashboard></p></li></ol><footer class=footline></footer></div></div><div id=navigation><a class="nav nav-prev" href=/ghpages-test/wcsites-domains/manage-wcsites-domains/weblogic-logging-exporter-setup/ title="d. Publish logs to Elasticsearch"><i class="fa fa-chevron-left"></i></a><a class="nav nav-next" href=/ghpages-test/wcsites-domains/known-issues/ title="Known Issues in WCSites" style=margin-right:0><i class="fa fa-chevron-right"></i></a></div></section><div style=left:-1000px;overflow:scroll;position:absolute;top:-1000px;border:none;box-sizing:content-box;height:200px;margin:0;padding:0;width:200px><div style=border:none;box-sizing:content-box;height:200px;margin:0;padding:0;width:200px></div></div><script src=/ghpages-test/js/clipboard.min.js?1584947815></script><script src=/ghpages-test/js/perfect-scrollbar.min.js?1584947815></script><script src=/ghpages-test/js/perfect-scrollbar.jquery.min.js?1584947815></script><script src=/ghpages-test/js/jquery.sticky.js?1584947815></script><script src=/ghpages-test/js/featherlight.min.js?1584947815></script><script src=/ghpages-test/js/highlight.pack.js?1584947815></script><script>hljs.initHighlightingOnLoad();</script><script src=/ghpages-test/js/modernizr.custom-3.6.0.js?1584947815></script><script src=/ghpages-test/js/learn.js?1584947815></script><script src=/ghpages-test/js/hugo-learn.js?1584947815></script><link href=/ghpages-test/mermaid/mermaid.css?1584947815 rel=stylesheet><script src=/ghpages-test/mermaid/mermaid.js?1584947815></script><script>mermaid.initialize({startOnLoad:true});</script></body></html>