<!doctype html><html lang=en class="js csstransforms3d"><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=generator content="Hugo 0.53"><meta name=description content="Sample for creating a SOA Suite domain home on an existing PV or PVC, and the domain resource YAML file for deploying the generated SOA domain."><link rel=icon href=/ghpages-test/images/favicon.png type=image/png><title>Create SOA domains :: Oracle Fusion Middleware on Kubernetes</title><link href=/ghpages-test/css/nucleus.css?1584947815 rel=stylesheet><link href=/ghpages-test/css/fontawesome-all.min.css?1584947815 rel=stylesheet><link href=/ghpages-test/css/hybrid.css?1584947815 rel=stylesheet><link href=/ghpages-test/css/featherlight.min.css?1584947815 rel=stylesheet><link href=/ghpages-test/css/perfect-scrollbar.min.css?1584947815 rel=stylesheet><link href=/ghpages-test/css/auto-complete.css?1584947815 rel=stylesheet><link href=/ghpages-test/css/atom-one-dark-reasonable.css?1584947815 rel=stylesheet><link href=/ghpages-test/css/theme.css?1584947815 rel=stylesheet><link href=/ghpages-test/css/hugo-theme.css?1584947815 rel=stylesheet><script src=/ghpages-test/js/jquery-3.3.1.min.js?1584947815></script><style>:root #header+#content>#left>#rlblock_left{display:none!important}</style></head><body data-url=/ghpages-test/soa-domains/create-soa-domains/><nav id=sidebar><div id=header-wrapper><div id=header><a id=logo href=/ghpages-test/><img src=/ghpages-test//images/fmw_12c_12_2_1_4_0-logo.png height=100><br><b>Oracle Fusion Middleware on Kubernetes</b></a></div><div class=searchbox><label for=search-by><i class="fas fa-search"></i></label><input data-search-input id=search-by type=search placeholder=Search...>
<span data-search-clear><i class="fas fa-times"></i></span></div><script type=text/javascript src=/ghpages-test/js/lunr.min.js?1584947815></script><script type=text/javascript src=/ghpages-test/js/auto-complete.js?1584947815></script><script type=text/javascript>var baseurl="\/ghpages-test\/";</script><script type=text/javascript src=/ghpages-test/js/search.js?1584947815></script></div><div class=highlightable><ul class=topics><li><a class=padding href=/fmw-kubernetes/>Home</a></li><li data-nav-id=/ghpages-test/soa-domains/ title="Oracle SOA Suite" class="dd-item 
        parent"><a href=/ghpages-test/soa-domains/>Oracle SOA Suite</a><ul><li data-nav-id=/ghpages-test/soa-domains/prerequisites/ title=Prerequisites class=dd-item><a href=/ghpages-test/soa-domains/prerequisites/><b>1. </b>Prerequisites</a></li><li data-nav-id=/ghpages-test/soa-domains/prepare-your-environment/ title="Prepare your environment" class=dd-item><a href=/ghpages-test/soa-domains/prepare-your-environment/><b>2. </b>Prepare your environment</a></li><li data-nav-id=/ghpages-test/soa-domains/create-soa-domains/ title="Create SOA domains" class="dd-item 
        parent
        active"><a href=/ghpages-test/soa-domains/create-soa-domains/><b>3. </b>Create SOA domains</a></li><li data-nav-id=/ghpages-test/soa-domains/manage-soa-domains/ title="Manage SOA Domains" class=dd-item><a href=/ghpages-test/soa-domains/manage-soa-domains/><b>4. </b>Manage SOA Domains</a><ul><li data-nav-id=/ghpages-test/soa-domains/manage-soa-domains/configuring-load-balancer/ title="Configuring a load balancer for SOA Domains" class=dd-item><a href=/ghpages-test/soa-domains/manage-soa-domains/configuring-load-balancer/><b>1. </b>Configuring a load balancer for SOA Domains</a></li><li data-nav-id=/ghpages-test/soa-domains/manage-soa-domains/monitoring-soa-domains/ title="Monitoring a SOA domain" class=dd-item><a href=/ghpages-test/soa-domains/manage-soa-domains/monitoring-soa-domains/><b>2. </b>Monitoring a SOA domain</a></li><li data-nav-id=/ghpages-test/soa-domains/manage-soa-domains/delete-domain-home/ title="Delete the SOA domain home" class=dd-item><a href=/ghpages-test/soa-domains/manage-soa-domains/delete-domain-home/><b>3. </b>Delete the SOA domain home</a></li><li data-nav-id=/ghpages-test/soa-domains/manage-soa-domains/supportjdev/ title="Deploying SOA Composites from Oracle JDeveloper" class=dd-item><a href=/ghpages-test/soa-domains/manage-soa-domains/supportjdev/><b>4. </b>Deploying SOA Composites from Oracle JDeveloper</a></li><li data-nav-id=/ghpages-test/soa-domains/manage-soa-domains/enablingt3/ title="Expose T3 protocol for Managed Servers" class=dd-item><a href=/ghpages-test/soa-domains/manage-soa-domains/enablingt3/><b>5. </b>Expose T3 protocol for Managed Servers</a></li><li data-nav-id=/ghpages-test/soa-domains/manage-soa-domains/persisting-soa-adapters-customizations/ title="Persisting SOA Adapters Customizations" class=dd-item><a href=/ghpages-test/soa-domains/manage-soa-domains/persisting-soa-adapters-customizations/><b>6. </b>Persisting SOA Adapters Customizations</a></li></ul></li><li data-nav-id=/ghpages-test/soa-domains/patch-soa-domains/ title="Patch SOA domains" class=dd-item><a href=/ghpages-test/soa-domains/patch-soa-domains/><b>5. </b>Patch SOA domains</a></li><li data-nav-id=/ghpages-test/soa-domains/known-issues/ title="Known Issues" class=dd-item><a href=/ghpages-test/soa-domains/known-issues/><b>6. </b>Known Issues</a></li><li data-nav-id=/ghpages-test/soa-domains/release-notes/ title="Release Notes" class=dd-item><a href=/ghpages-test/soa-domains/release-notes/>Release Notes</a></li></ul></li><li data-nav-id=/ghpages-test/wcsites-domains/ title="Oracle WebCenter Sites" class=dd-item><a href=/ghpages-test/wcsites-domains/>Oracle WebCenter Sites</a><ul><li data-nav-id=/ghpages-test/wcsites-domains/pre-requisites/ title=Pre-requisites class=dd-item><a href=/ghpages-test/wcsites-domains/pre-requisites/><b>1. </b>Pre-requisites</a></li><li data-nav-id=/ghpages-test/wcsites-domains/prepare-your-environment/ title="Prepare your environment" class=dd-item><a href=/ghpages-test/wcsites-domains/prepare-your-environment/><b>2. </b>Prepare your environment</a></li><li data-nav-id=/ghpages-test/wcsites-domains/create-wcsites-domains/ title="Create WebCenter Sites domains" class=dd-item><a href=/ghpages-test/wcsites-domains/create-wcsites-domains/><b>3. </b>Create WebCenter Sites domains</a></li><li data-nav-id=/ghpages-test/wcsites-domains/manage-wcsites-domains/ title="Manage WebCenter Sites domains" class=dd-item><a href=/ghpages-test/wcsites-domains/manage-wcsites-domains/><b>4. </b>Manage WebCenter Sites domains</a><ul><li data-nav-id=/ghpages-test/wcsites-domains/manage-wcsites-domains/loadbalancer-traefik-setup-for-wcsites-domain-setup-on-k8s/ title="a. Using Traefik Loadbalancer" class=dd-item><a href=/ghpages-test/wcsites-domains/manage-wcsites-domains/loadbalancer-traefik-setup-for-wcsites-domain-setup-on-k8s/>a. Using Traefik Loadbalancer</a></li><li data-nav-id=/ghpages-test/wcsites-domains/manage-wcsites-domains/loadbalancer-voyager-setup-for-wcsites-domain-setup-on-k8s/ title="b. Using Voyager Loadbalancer" class=dd-item><a href=/ghpages-test/wcsites-domains/manage-wcsites-domains/loadbalancer-voyager-setup-for-wcsites-domain-setup-on-k8s/>b. Using Voyager Loadbalancer</a></li><li data-nav-id=/ghpages-test/wcsites-domains/manage-wcsites-domains/elasticsearch-integration-with-wls-operator-wls-server-logs/ title="c. ELK Integration for Logs" class=dd-item><a href=/ghpages-test/wcsites-domains/manage-wcsites-domains/elasticsearch-integration-with-wls-operator-wls-server-logs/>c. ELK Integration for Logs</a></li><li data-nav-id=/ghpages-test/wcsites-domains/manage-wcsites-domains/weblogic-logging-exporter-setup/ title="d. Publish logs to Elasticsearch" class=dd-item><a href=/ghpages-test/wcsites-domains/manage-wcsites-domains/weblogic-logging-exporter-setup/>d. Publish logs to Elasticsearch</a></li><li data-nav-id=/ghpages-test/wcsites-domains/manage-wcsites-domains/weblogic-monitoring-exporter-setup/ title="e. Monitor a WebCenter Sites domain" class=dd-item><a href=/ghpages-test/wcsites-domains/manage-wcsites-domains/weblogic-monitoring-exporter-setup/>e. Monitor a WebCenter Sites domain</a></li></ul></li><li data-nav-id=/ghpages-test/wcsites-domains/known-issues/ title="Known Issues in WCSites" class=dd-item><a href=/ghpages-test/wcsites-domains/known-issues/><b>6. </b>Known Issues in WCSites</a></li><li data-nav-id=/ghpages-test/wcsites-domains/release-notes/ title="Release Notes" class=dd-item><a href=/ghpages-test/wcsites-domains/release-notes/>Release Notes</a></li></ul></li></ul><section id=footer><p>Created with <i class="fas fa-heart"></i>from <a href=https://www.oracle.com>Oracle</a></p><p>&nbsp;</p><p><a href=https://github.com/oracle/fmw-kubernetes><i class="fab fa-github"></i>GitHub repo</a></p><p><a href=https://weblogic-slack-inviter.herokuapp.com/><i class="fab fa-slack"></i>Public Slack #</a></p></section></div></nav><section id=body><div id=overlay></div><div class="padding highlightable"><div><div id=top-bar><div id=breadcrumbs itemscope itemtype=http://data-vocabulary.org/Breadcrumb><span id=sidebar-toggle-span><a href=# id=sidebar-toggle data-sidebar-toggle><i class="fas fa-bars"></i></a></span><span id=toc-menu><i class="fas fa-list-alt"></i></span><span class=links><a href=/ghpages-test/>Oracle Fusion Middleware on Kubernetes</a> > <a href=/ghpages-test/soa-domains/>Oracle SOA Suite</a> > Create SOA domains</span></div><div class=progress><div class=wrapper><nav id=TableOfContents><ul><li><ul><li><ul><li><ul><li><a href=#prerequisites>Prerequisites</a></li><li><a href=#prepare-to-use-the-create-domain-script>Prepare to use the create domain script</a></li><li><a href=#configuration-parameters>Configuration parameters</a></li><li><a href=#run-the-create-domain-script>Run the create domain script</a></li><li><a href=#verify-the-results>Verify the results</a><ul><li><a href=#generated-yaml-files-with-the-default-inputs>Generated YAML files with the default inputs</a></li></ul></li><li><a href=#verify-the-domain>Verify the domain</a></li><li><a href=#verify-the-pods>Verify the pods</a></li><li><a href=#verify-the-services>Verify the services</a></li></ul></li></ul></li></ul></li></ul></nav></div></div></div></div><div id=head-tags></div><div id=body-inner><h1>Create SOA domains</h1><div class="notices warning"><p>Oracle SOA Suite is currently supported only for non-production use in Docker and Kubernetes. The information provided
in this document is a <em>preview</em> for early adopters who wish to experiment with Oracle SOA Suite in Kubernetes before
it is supported for production use.</p></div><p>The SOA deployment scripts demonstrate the creation of a SOA Suite domain home on an existing Kubernetes persistent volume (PV) and persistent volume claim (PVC). The scripts also generate the domain YAML file, which can then be used to start the Kubernetes artifacts of the corresponding domain.</p><h4 id=prerequisites>Prerequisites</h4><p>Before you begin, we recommend to accomplish the following:</p><ol><li>Review the <a href=https://oracle.github.io/weblogic-kubernetes-operator/userguide/managing-domains/domain-resource>Domain resource</a> documentation.</li><li>Review the complete information available in <a href=/ghpages-test/soa-domains/prerequisites/>prerequisites</a> document.</li><li>Ensure that you have executed all the preliminary steps documented in <a href=/ghpages-test/soa-domains/prepare-your-environment/>prepare-your-environment</a>.</li><li>Ensure that the database and the Weblogic Kubernetes operator is up.</li></ol><h4 id=prepare-to-use-the-create-domain-script>Prepare to use the create domain script</h4><p>The sample scripts for Oracle SOA Suite domain deployment are available at <code>&lt;weblogic-kubernetes-operator-project&gt;/kubernetes/samples/scripts/create-soa-domain</code>.</p><p>You must edit <code>create-domain-inputs.yaml</code> (or a copy of it) to provide the details for your domain.
Please refer to the configuration parameters below to understand the information that you must
provide in this file.</p><h4 id=configuration-parameters>Configuration parameters</h4><p>The following parameters can be provided in the inputs file.</p><table><thead><tr><th>Parameter</th><th>Definition</th><th>Default</th></tr></thead><tbody><tr><td><code>adminPort</code></td><td>Port number for the Administration Server inside the Kubernetes cluster.</td><td><code>7001</code></td></tr><tr><td><code>adminNodePort</code></td><td>Port number of the Administration Server outside the Kubernetes cluster.</td><td><code>30701</code></td></tr><tr><td><code>adminServerName</code></td><td>Name of the Administration Server.</td><td><code>AdminServer</code></td></tr><tr><td><code>clusterName</code></td><td>Name of the WebLogic cluster instance to generate for the domain. By default the cluster name is <code>soa_cluster</code> for the SOA domain. You can update this to <code>osb_cluster</code> for an OSB domain type or <code>soa_cluster</code> for SOAESS or SOAOSB or SOAESSOSB domain types.</td><td><code>soa_cluster</code></td></tr><tr><td><code>configuredManagedServerCount</code></td><td>Number of Managed Server instances to generate for the domain.</td><td><code>5</code></td></tr><tr><td><code>createDomainFilesDir</code></td><td>Directory on the host machine to locate all the files to create a WebLogic domain, including the script that is specified in the <code>createDomainScriptName</code> property. By default, this directory is set to the relative path <code>wlst</code>, and the create script will use the built-in WLST offline scripts in the <code>wlst</code> directory to create the WebLogic domain. It can also be set to the relative path <code>wdt</code>, and then the built-in WDT scripts will be used instead. An absolute path is also supported to point to an arbitrary directory in the file system. The built-in scripts can be replaced by the user-provided scripts or model files as long as those files are in the specified directory. Files in this directory are put into a Kubernetes config map, which in turn is mounted to the <code>createDomainScriptsMountPath</code>, so that the Kubernetes pod can use the scripts and supporting files to create a domain home.</td><td><code>wlst</code></td></tr><tr><td><code>createDomainScriptsMountPath</code></td><td>Mount path where the create domain scripts are located inside a pod. The <code>create-domain.sh</code> script creates a Kubernetes job to run the script (specified in the <code>createDomainScriptName</code> property) in a Kubernetes pod to create a domain home. Files in the <code>createDomainFilesDir</code> directory are mounted to this location in the pod, so that the Kubernetes pod can use the scripts and supporting files to create a domain home.</td><td><code>/u01/weblogic</code></td></tr><tr><td><code>createDomainScriptName</code></td><td>Script that the create domain script uses to create a WebLogic domain. The <code>create-domain.sh</code> script creates a Kubernetes job to run this script to create a domain home. The script is located in the in-pod directory that is specified in the <code>createDomainScriptsMountPath</code> property. If you need to provide your own scripts to create the domain home, instead of using the built-it scripts, you must use this property to set the name of the script that you want the create domain job to run.</td><td><code>create-domain-job.sh</code></td></tr><tr><td><code>domainHome</code></td><td>Home directory of the SOA domain. If not specified, the value is derived from the <code>domainUID</code> as <code>/shared/domains/&lt;domainUID&gt;</code>.</td><td><code>/u01/oracle/user_projects/domains/soainfra</code></td></tr><tr><td><code>domainPVMountPath</code></td><td>Mount path of the domain persistent volume.</td><td><code>/u01/oracle/user_projects</code></td></tr><tr><td><code>domainUID</code></td><td>Unique ID that will be used to identify this particular domain. Used as the name of the generated WebLogic domain as well as the name of the Kubernetes domain resource. This ID must be unique across all domains in a Kubernetes cluster. This ID cannot contain any character that is not valid in a Kubernetes service name.</td><td><code>soainfra</code></td></tr><tr><td><code>domainType</code></td><td>Type of the domain. Mandatory input for SOA Suite domains. You must provide one of the supported domain type values: <code>soa</code> (deploys a SOA domain),<code>osb</code> (deploys an OSB (Oracle Service Bus) domain),<code>soaess</code> (deploys a SOA domain with Enterprise Scheduler (ESS)),<code>soaosb</code> (deploys a domain with SOA and OSB), and <code>soaessosb</code> (deploys a domain with SOA, OSB, and ESS).</td><td><code>soa</code></td></tr><tr><td><code>exposeAdminNodePort</code></td><td>Boolean indicating if the Administration Server is exposed outside of the Kubernetes cluster.</td><td><code>false</code></td></tr><tr><td><code>exposeAdminT3Channel</code></td><td>Boolean indicating if the T3 administrative channel is exposed outside the Kubernetes cluster.</td><td><code>false</code></td></tr><tr><td><code>image</code></td><td>SOA Suite Docker image. The operator requires SOA Suite 12.2.1.4. Refer to <a href=/ghpages-test/soa-domains/manage-soa-domains/#obtaining-the-soa-suite-docker-image>SOA domains</a> for details on how to obtain or create the image.</td><td><code>container-registry.oracle.com/middleware/soasuite:12.2.1.4</code></td></tr><tr><td><code>imagePullPolicy</code></td><td>WebLogic Docker image pull policy. Legal values are <code>IfNotPresent</code>, <code>Always</code>, or <code>Never</code></td><td><code>IfNotPresent</code></td></tr><tr><td><code>imagePullSecretName</code></td><td>Name of the Kubernetes secret to access the Docker Store to pull the WebLogic Server Docker image. The presence of the secret will be validated when this parameter is specified.</td><td></td></tr><tr><td><code>includeServerOutInPodLog</code></td><td>Boolean indicating whether to include the server .out to the pod&rsquo;s stdout.</td><td><code>true</code></td></tr><tr><td><code>initialManagedServerReplicas</code></td><td>Number of Managed Servers to initially start for the domain.</td><td><code>2</code></td></tr><tr><td><code>javaOptions</code></td><td>Java options for starting the Administration Server and Managed Servers. A Java option can have references to one or more of the following pre-defined variables to obtain WebLogic domain information: <code>$(DOMAIN_NAME)</code>, <code>$(DOMAIN_HOME)</code>, <code>$(ADMIN_NAME)</code>, <code>$(ADMIN_PORT)</code>, and <code>$(SERVER_NAME)</code>.</td><td><code>-Dweblogic.StdoutDebugEnabled=false</code></td></tr><tr><td><code>logHome</code></td><td>The in-pod location for the domain log, server logs, server out, and Node Manager log files. If not specified, the value is derived from the <code>domainUID</code> as <code>/shared/logs/&lt;domainUID&gt;</code>.</td><td><code>/u01/oracle/user_projects/domains/logs/soainfra</code></td></tr><tr><td><code>managedServerNameBase</code></td><td>Base string used to generate Managed Server names.</td><td><code>soa_server</code></td></tr><tr><td><code>managedServerPort</code></td><td>Port number for each Managed Server.</td><td><code>8001</code></td></tr><tr><td><code>namespace</code></td><td>Kubernetes namespace in which to create the domain.</td><td><code>soans</code></td></tr><tr><td><code>persistentVolumeClaimName</code></td><td>Name of the persistent volume claim created to host the domain home. If not specified, the value is derived from the <code>domainUID</code> as <code>&lt;domainUID&gt;-weblogic-sample-pvc</code>.</td><td><code>soainfra-domain-pvc</code></td></tr><tr><td><code>productionModeEnabled</code></td><td>Boolean indicating if production mode is enabled for the domain.</td><td><code>true</code></td></tr><tr><td><code>serverStartPolicy</code></td><td>Determines which WebLogic Server instances will be started. Legal values are <code>NEVER</code>, <code>IF_NEEDED</code>, <code>ADMIN_ONLY</code>.</td><td><code>IF_NEEDED</code></td></tr><tr><td><code>t3ChannelPort</code></td><td>Port for the T3 channel of the NetworkAccessPoint.</td><td><code>30012</code></td></tr><tr><td><code>t3PublicAddress</code></td><td>Public address for the T3 channel. This should be set to the public address of the Kubernetes cluster. This would typically be a load balancer address.<p>For development environments only: In a single server (all-in-one) Kubernetes deployment, this may be set to the address of the master, or at the very least, it must be set to the address of one of the worker nodes.</td><td>If not provided, the script will attempt to set it to the IP address of the Kubernetes cluster</td></tr><tr><td><code>weblogicCredentialsSecretName</code></td><td>Name of the Kubernetes secret for the Administration Server&rsquo;s user name and password. If not specified, then the value is derived from the <code>domainUID</code> as <code>&lt;domainUID&gt;-weblogic-credentials</code>.</td><td><code>soainfra-domain-credentials</code></td></tr><tr><td><code>weblogicImagePullSecretName</code></td><td>Name of the Kubernetes secret for the Docker Store, used to pull the WebLogic Server image.</td><td></td></tr><tr><td><code>serverPodCpuRequest</code>, <code>serverPodMemoryRequest</code>, <code>serverPodCpuCLimit</code>, <code>serverPodMemoryLimit</code></td><td>The maximum amount of compute resources allowed, and minimum amount of compute resources required, for each server pod. Please refer to the Kubernetes documentation on <code>Managing Compute Resources for Containers</code> for details.</td><td>Resource requests and resource limits are not specified.</td></tr><tr><td><code>rcuSchemaPrefix</code></td><td>The schema prefix to use in the database, for example <code>SOA1</code>. You may wish to make this the same as the domainUID in order to simplify matching domains to their RCU schemas.</td><td><code>SOA1</code></td></tr><tr><td><code>rcuDatabaseURL</code></td><td>The database URL.</td><td><code>oracle-db.default.svc.cluster.local:1521/devpdb.k8s</code></td></tr><tr><td><code>rcuCredentialsSecret</code></td><td>The Kubernetes secret containing the database credentials.</td><td><code>soainfra-rcu-credentials</code></td></tr></tbody></table><p>Note that the names of the Kubernetes resources in the generated YAML files may be formed with the
value of some of the properties specified in the <code>create-inputs.yaml</code> file. Those properties include
the <code>adminServerName</code>, <code>clusterName</code> and <code>managedServerNameBase</code>. If those values contain any
characters that are invalid in a Kubernetes service name, those characters are converted to
valid values in the generated YAML files. For example, an uppercase letter is converted to a
lowercase letter and an underscore <code>(&quot;_&quot;)</code> is converted to a hyphen <code>(&quot;-&quot;)</code>.</p><p>The sample demonstrates how to create a SOA Suite domain home and associated Kubernetes resources for a domain
that has one cluster only. In addition, the sample provides the capability for users to supply their own scripts
to create the domain home for other use cases. The generated domain YAML file could also be modified to cover more use cases.</p><h4 id=run-the-create-domain-script>Run the create domain script</h4><p>Run the create domain script, specifying your inputs file and an output directory to store the
generated artifacts:</p><pre><code>$ ./create-domain.sh \
  -i create-domain-inputs.yaml \
  -o /&lt;path to output-directory&gt;
</code></pre><p>The script will perform the following steps:</p><ul><li>Create a directory for the generated Kubernetes YAML files for this domain if it does not
already exist. The path name is <code>/&lt;path to output-directory&gt;/weblogic-domains/&lt;domainUID&gt;</code>.
If the directory already exists, its contents must be removed before using this script.</li><li>Create a Kubernetes job that will start up a utility SOA Suite container and run
offline WLST scripts to create the domain on the shared storage.</li><li>Run and wait for the job to finish.</li><li><p>Create a Kubernetes domain YAML file, <code>domain.yaml</code>, in the &ldquo;output&rdquo; directory that was created above.
This YAML file can be used to create the Kubernetes resource using the <code>kubectl create -f</code>
or <code>kubectl apply -f</code> command:</p><pre><code>$ kubectl apply -f /&lt;path to output-directory&gt;/weblogic-domains/&lt;domainUID&gt;/domain.yaml
</code></pre></li><li><p>Create a convenient utility script, <code>delete-domain-job.yaml</code>, to clean up the domain home
created by the create script.</p></li></ul><p>The default domain created by the script has the following characteristics:</p><ul><li>An Administration Server named <code>AdminServer</code> listening on port <code>7001</code>.</li><li>A configured cluster named <code>soa_cluster-1</code> of size 5.</li><li>Two Managed Servers, named <code>soa_server1</code> and <code>soa_server2</code>, listening on port <code>8001</code>.</li><li>Log files that are located in <code>/shared/logs/&lt;domainUID&gt;</code>.</li><li>SOA Infra, SOA composer and WorklistApp applications deployed.</li><li>No data sources or JMS resources.</li><li>A T3 channel.</li></ul><h4 id=verify-the-results>Verify the results</h4><p>The create domain script will verify that the domain was created, and will report failure if there was any error.
However, it may be desirable to manually verify the domain, even if just to gain familiarity with the
various Kubernetes objects that were created by the script.</p><p>Note that the example results below use the <code>default</code> Kubernetes namespace. If you are using a different
namespace, you need to replace <code>NAMESPACE</code> in the example <code>kubectl</code> commands with the actual Kubernetes namespace.</p><h5 id=generated-yaml-files-with-the-default-inputs>Generated YAML files with the default inputs</h5><p>The content of the generated <code>domain.yaml</code>:</p><pre><code>$ cat output/weblogic-domains/soainfra/domain.yaml
# Copyright (c) 2017, 2019, Oracle Corporation and/or its affiliates. All rights reserved.
# Licensed under the Universal Permissive License v 1.0 as shown at https://oss.oracle.com/licenses/upl.
#
# This is an example of how to define a Domain resource.
#
apiVersion: &quot;weblogic.oracle/v6&quot;
kind: Domain
metadata:
  name: soainfra
  namespace: soans
  labels:
    weblogic.resourceVersion: domain-v2
    weblogic.domainUID: soainfra
spec:
  # The WebLogic Domain Home
  domainHome: /u01/oracle/user_projects/domains/soainfra

  # If the domain home is in the image
  domainHomeInImage: false

  # The WebLogic Server Docker image that the Operator uses to start the domain
  image: &quot;container-registry.oracle.com/middleware/soasuite:12.2.1.4&quot;

  # imagePullPolicy defaults to &quot;Always&quot; if image version is :latest
  imagePullPolicy: &quot;IfNotPresent&quot;

  # Identify which Secret contains the credentials for pulling an image
  #imagePullSecrets:
  #- name:

  # Identify which Secret contains the WebLogic Admin credentials (note that there is an example of
  # how to create that Secret at the end of this file)
  webLogicCredentialsSecret:
    name: soainfra-domain-credentials

  # Whether to include the server out file into the pod's stdout, default is true
  includeServerOutInPodLog: true

  # Whether to enable log home
  logHomeEnabled: true

  # The in-pod location for domain log, server logs, server out, and Node Manager log files
  logHome: /u01/oracle/user_projects/domains/logs/soainfra
  # An (optional) in-pod location for data storage of default and custom file stores.
  # If not specified or the value is either not set or empty (e.g. dataHome: &quot;&quot;) then the
  # data storage directories are determined from the WebLogic domain home configuration.
  dataHome: &quot;&quot;

  # serverStartPolicy legal values are &quot;NEVER&quot;, &quot;IF_NEEDED&quot;, or &quot;ADMIN_ONLY&quot;
  # This determines which WebLogic Servers the Operator will start up when it discovers this Domain
  # - &quot;NEVER&quot; will not start any server in the domain
  # - &quot;ADMIN_ONLY&quot; will start up only the administration server (no managed servers will be started)
  # - &quot;IF_NEEDED&quot; will start all non-clustered servers, including the administration server and clustered servers up to the replica count
  serverStartPolicy: &quot;IF_NEEDED&quot;

  serverService:
    precreateService: true

  serverPod:  
    # an (optional) list of environment variable to be set on the servers
    env:
    - name: JAVA_OPTIONS
      value: &quot;-Dweblogic.StdoutDebugEnabled=false&quot;
    - name: USER_MEM_ARGS
      value: &quot;-Djava.security.egd=file:/dev/./urandom &quot;
    volumes:
    - name: weblogic-domain-storage-volume
      persistentVolumeClaim:
        claimName: soainfra-domain-pvc
    volumeMounts:
    - mountPath: /u01/oracle/user_projects
      name: weblogic-domain-storage-volume

  # adminServer is used to configure the desired behavior for starting the administration server.
  adminServer:
    # serverStartState legal values are &quot;RUNNING&quot; or &quot;ADMIN&quot;
    # &quot;RUNNING&quot; means the listed server will be started up to &quot;RUNNING&quot; mode
    # &quot;ADMIN&quot; means the listed server will be start up to &quot;ADMIN&quot; mode
    serverStartState: &quot;RUNNING&quot;
    # adminService:
    #   channels:
    # The Admin Server's NodePort
    #    - channelName: default
    #      nodePort: 30701
    # Uncomment to export the T3Channel as a service
    #    - channelName: T3Channel

  # clusters is used to configure the desired behavior for starting member servers of a cluster.
  # If you use this entry, then the rules will be applied to ALL servers that are members of the named clusters.
  clusters:
  - clusterName: osb_cluster
    serverService:
      precreateService: true
    serverStartState: &quot;RUNNING&quot;
    replicas: 2
  # The number of managed servers to start for unlisted clusters
  # replicas: 1

  - clusterName: soa_cluster
    serverService:
      precreateService: true
    serverStartState: &quot;RUNNING&quot;
    replicas: 2
  # The number of managed servers to start for unlisted clusters
  # replicas: 1
</code></pre><h4 id=verify-the-domain>Verify the domain</h4><p>To confirm that the domain was created, use this command:</p><pre><code>$ kubectl describe domain DOMAINUID -n NAMESPACE
</code></pre><p>Replace <code>DOMAINUID</code> with the <code>domainUID</code> and <code>NAMESPACE</code> with the actual namespace.</p><p>Here is an example of the output of this command:</p><pre><code>$ kubectl describe domain soainfra -n soans
Name:         soainfra
Namespace:    soans
Labels:       weblogic.domainUID=soainfra
              weblogic.resourceVersion=domain-v2
Annotations:  &lt;none&gt;
API Version:  weblogic.oracle/v6
Kind:         Domain
Metadata:
  Creation Timestamp:  2020-01-27T10:04:11Z
  Generation:          6
  Resource Version:    18537800
  Self Link:           /apis/weblogic.oracle/v6/namespaces/soans/domains/soainfra
  UID:                 5dcb76e4-40ec-11ea-b332-020017041cc2
Spec:
  Admin Server:
    Admin Service:
      Annotations:
      Channels:
      Labels:
    Server Pod:
      Annotations:
      Container Security Context:
      Containers:
      Env:
      Init Containers:
      Labels:
      Liveness Probe:
      Node Selector:
      Pod Security Context:
      Readiness Gates:
      Readiness Probe:
      Resources:
        Limits:
        Requests:
      Shutdown:
      Tolerations:
      Volume Mounts:
      Volumes:
    Server Service:
      Annotations:
      Labels:
    Server Start State:  RUNNING
  Clusters:
    Cluster Name:  osb_cluster
    Cluster Service:
      Annotations:
      Labels:
    Replicas:  2
    Server Pod:
      Annotations:
      Container Security Context:
      Containers:
      Env:
      Init Containers:
      Labels:
      Liveness Probe:
      Node Selector:
      Pod Security Context:
      Readiness Gates:
      Readiness Probe:
      Resources:
        Limits:
        Requests:
      Shutdown:
      Tolerations:
      Volume Mounts:
      Volumes:
    Server Service:
      Annotations:
      Labels:
      Precreate Service:  true
    Server Start State:   RUNNING
    Cluster Name:         soa_cluster
    Cluster Service:
      Annotations:
      Labels:
    Replicas:  2
    Server Pod:
      Annotations:
      Container Security Context:
      Containers:
      Env:
      Init Containers:
      Labels:
      Liveness Probe:
      Node Selector:
      Pod Security Context:
      Readiness Gates:
      Readiness Probe:
      Resources:
        Limits:
        Requests:
      Shutdown:
      Tolerations:
      Volume Mounts:
      Volumes:
    Server Service:
      Annotations:
      Labels:
      Precreate Service:          true
    Server Start State:           RUNNING
  Data Home:
  Domain Home:                    /u01/oracle/user_projects/domains/soainfra
  Domain Home In Image:           false
  Image:                          container-registry.oracle.com/middleware/soasuite:12.2.1.4.
  Image Pull Policy:              IfNotPresent
  Include Server Out In Pod Log:  true
  Log Home:                       /u01/oracle/user_projects/domains/logs/soainfra
  Log Home Enabled:               true
  Managed Servers:
  Server Pod:
    Annotations:
    Container Security Context:
    Containers:
    Env:
      Name:   JAVA_OPTIONS
      Value:  -Dweblogic.StdoutDebugEnabled=false
      Name:   USER_MEM_ARGS
      Value:  -Djava.security.egd=file:/dev/./urandom
    Init Containers:
    Labels:
    Liveness Probe:
    Node Selector:
    Pod Security Context:
    Readiness Gates:
    Readiness Probe:
    Resources:
      Limits:
      Requests:
    Shutdown:
    Tolerations:
    Volume Mounts:
      Mount Path:  /u01/oracle/user_projects
      Name:        weblogic-domain-storage-volume
    Volumes:
      Name:  weblogic-domain-storage-volume
      Persistent Volume Claim:
        Claim Name:  soainfra-domain-pvc
  Server Service:
    Annotations:
    Labels:
  Server Start Policy:  IF_NEEDED
  Web Logic Credentials Secret:
    Name:  soainfra-domain-credentials
Status:
  Clusters:
    Cluster Name:      soa_cluster
    Maximum Replicas:  5
    Cluster Name:      osb_cluster
    Maximum Replicas:  5
  Conditions:
  Servers:
    Health:
      Activation Time:  2020-01-27T10:08:18.876Z
      Overall Health:   ok
      Subsystems:
    Node Name:    MyNode
    Server Name:  AdminServer
    State:        RUNNING
  Start Time:     2020-01-27T10:04:11.853Z
Events:           &lt;none&gt;
</code></pre><p>In the <code>Status</code> section of the output, the available servers and clusters are listed.
Note that if this command is issued very soon after the script finishes, there may be
no servers available yet, or perhaps only the Administration Server but no Managed Servers.
The operator will start up the Administration Server first and wait for it to become ready
before starting the Managed Servers.</p><h4 id=verify-the-pods>Verify the pods</h4><p>Use the following command to see the pods running the servers:</p><pre><code>$ kubectl get pods -n NAMESPACE
</code></pre><p>Here is an example of the output of this command. You can verify that an Administration Server and two Managed Servers for each cluster (SOA and OSB) are running for <code>soaessosb</code> domain type.</p><pre><code>$ kubectl get pods -n soans
NAME                                                READY   STATUS      RESTARTS   AGE
soainfra-adminserver                                1/1     Running     0          20h
soainfra-osb-server1                                1/1     Running     0          20h
soainfra-osb-server2                                1/1     Running     0          20h
soainfra-soa-server1                                1/1     Running     0          20h
soainfra-soa-server2                                1/1     Running     0          20h
</code></pre><h4 id=verify-the-services>Verify the services</h4><p>Use the following command to see the services for the domain:</p><pre><code>$ kubectl get services -n NAMESPACE
</code></pre><p>Here is an example of the output of this command. You can verify that services for Administration Server and Managed Servers (for SOA and OSB clusters) are created for <code>soaessosb</code> domain type.</p><pre><code>$ kubectl get services -n soans
NAME                            TYPE           CLUSTER-IP       EXTERNAL-IP   PORT(S)                       AGE
soainfra-adminserver            ClusterIP      None             &lt;none&gt;        7001/TCP                      20h
soainfra-cluster-osb-cluster    ClusterIP      10.110.6.107     &lt;none&gt;        9001/TCP                      20h
soainfra-cluster-soa-cluster    ClusterIP      10.100.165.105   &lt;none&gt;        8001/TCP                      20h
soainfra-osb-server1            ClusterIP      None             &lt;none&gt;        9001/TCP                      20h
soainfra-osb-server2            ClusterIP      None             &lt;none&gt;        9001/TCP                      20h
soainfra-osb-server3            ClusterIP      10.99.1.111      &lt;none&gt;        9001/TCP                      20h
soainfra-osb-server4            ClusterIP      10.106.178.175   &lt;none&gt;        9001/TCP                      20h
soainfra-osb-server5            ClusterIP      10.97.65.163     &lt;none&gt;        9001/TCP                      20h
soainfra-soa-server1            ClusterIP      None             &lt;none&gt;        8001/TCP                      20h
soainfra-soa-server2            ClusterIP      None             &lt;none&gt;        8001/TCP                      20h
soainfra-soa-server3            ClusterIP      10.104.189.192   &lt;none&gt;        8001/TCP                      20h
soainfra-soa-server4            ClusterIP      10.100.168.31    &lt;none&gt;        8001/TCP                      20h
soainfra-soa-server5            ClusterIP      10.101.171.78    &lt;none&gt;        8001/TCP                      20h
</code></pre><footer class=footline></footer></div></div><div id=navigation><a class="nav nav-prev" href=/ghpages-test/soa-domains/prepare-your-environment/ title="Prepare your environment"><i class="fa fa-chevron-left"></i></a><a class="nav nav-next" href=/ghpages-test/soa-domains/manage-soa-domains/ title="Manage SOA Domains" style=margin-right:0><i class="fa fa-chevron-right"></i></a></div></section><div style=left:-1000px;overflow:scroll;position:absolute;top:-1000px;border:none;box-sizing:content-box;height:200px;margin:0;padding:0;width:200px><div style=border:none;box-sizing:content-box;height:200px;margin:0;padding:0;width:200px></div></div><script src=/ghpages-test/js/clipboard.min.js?1584947815></script><script src=/ghpages-test/js/perfect-scrollbar.min.js?1584947815></script><script src=/ghpages-test/js/perfect-scrollbar.jquery.min.js?1584947815></script><script src=/ghpages-test/js/jquery.sticky.js?1584947815></script><script src=/ghpages-test/js/featherlight.min.js?1584947815></script><script src=/ghpages-test/js/highlight.pack.js?1584947815></script><script>hljs.initHighlightingOnLoad();</script><script src=/ghpages-test/js/modernizr.custom-3.6.0.js?1584947815></script><script src=/ghpages-test/js/learn.js?1584947815></script><script src=/ghpages-test/js/hugo-learn.js?1584947815></script><link href=/ghpages-test/mermaid/mermaid.css?1584947815 rel=stylesheet><script src=/ghpages-test/mermaid/mermaid.js?1584947815></script><script>mermaid.initialize({startOnLoad:true});</script></body></html>