<!doctype html><html lang=en class="js csstransforms3d"><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=generator content="Hugo 0.53"><meta name=description content="Learn how to create a T3 channel and the corresponding Kubernetes Service to expose the T3 protocol for Managed Servers in SOA Domain."><link rel=icon href=/ghpages-test/images/favicon.png type=image/png><title>Expose T3 protocol for Managed Servers :: Oracle Fusion Middleware on Kubernetes</title><link href=/ghpages-test/css/nucleus.css?1584947815 rel=stylesheet><link href=/ghpages-test/css/fontawesome-all.min.css?1584947815 rel=stylesheet><link href=/ghpages-test/css/hybrid.css?1584947815 rel=stylesheet><link href=/ghpages-test/css/featherlight.min.css?1584947815 rel=stylesheet><link href=/ghpages-test/css/perfect-scrollbar.min.css?1584947815 rel=stylesheet><link href=/ghpages-test/css/auto-complete.css?1584947815 rel=stylesheet><link href=/ghpages-test/css/atom-one-dark-reasonable.css?1584947815 rel=stylesheet><link href=/ghpages-test/css/theme.css?1584947815 rel=stylesheet><link href=/ghpages-test/css/hugo-theme.css?1584947815 rel=stylesheet><script src=/ghpages-test/js/jquery-3.3.1.min.js?1584947815></script><style>:root #header+#content>#left>#rlblock_left{display:none!important}</style></head><body data-url=/ghpages-test/soa-domains/manage-soa-domains/enablingt3/><nav id=sidebar><div id=header-wrapper><div id=header><a id=logo href=/ghpages-test/><img src=/ghpages-test//images/fmw_12c_12_2_1_4_0-logo.png height=100><br><b>Oracle Fusion Middleware on Kubernetes</b></a></div><div class=searchbox><label for=search-by><i class="fas fa-search"></i></label><input data-search-input id=search-by type=search placeholder=Search...>
<span data-search-clear><i class="fas fa-times"></i></span></div><script type=text/javascript src=/ghpages-test/js/lunr.min.js?1584947815></script><script type=text/javascript src=/ghpages-test/js/auto-complete.js?1584947815></script><script type=text/javascript>var baseurl="\/ghpages-test\/";</script><script type=text/javascript src=/ghpages-test/js/search.js?1584947815></script></div><div class=highlightable><ul class=topics><li><a class=padding href=/fmw-kubernetes/>Home</a></li><li data-nav-id=/ghpages-test/soa-domains/ title="Oracle SOA Suite" class="dd-item 
        parent"><a href=/ghpages-test/soa-domains/>Oracle SOA Suite</a><ul><li data-nav-id=/ghpages-test/soa-domains/prerequisites/ title=Prerequisites class=dd-item><a href=/ghpages-test/soa-domains/prerequisites/><b>1. </b>Prerequisites</a></li><li data-nav-id=/ghpages-test/soa-domains/prepare-your-environment/ title="Prepare your environment" class=dd-item><a href=/ghpages-test/soa-domains/prepare-your-environment/><b>2. </b>Prepare your environment</a></li><li data-nav-id=/ghpages-test/soa-domains/create-soa-domains/ title="Create SOA domains" class=dd-item><a href=/ghpages-test/soa-domains/create-soa-domains/><b>3. </b>Create SOA domains</a></li><li data-nav-id=/ghpages-test/soa-domains/manage-soa-domains/ title="Manage SOA Domains" class="dd-item 
        parent"><a href=/ghpages-test/soa-domains/manage-soa-domains/><b>4. </b>Manage SOA Domains</a><ul><li data-nav-id=/ghpages-test/soa-domains/manage-soa-domains/configuring-load-balancer/ title="Configuring a load balancer for SOA Domains" class=dd-item><a href=/ghpages-test/soa-domains/manage-soa-domains/configuring-load-balancer/><b>1. </b>Configuring a load balancer for SOA Domains</a></li><li data-nav-id=/ghpages-test/soa-domains/manage-soa-domains/monitoring-soa-domains/ title="Monitoring a SOA domain" class=dd-item><a href=/ghpages-test/soa-domains/manage-soa-domains/monitoring-soa-domains/><b>2. </b>Monitoring a SOA domain</a></li><li data-nav-id=/ghpages-test/soa-domains/manage-soa-domains/delete-domain-home/ title="Delete the SOA domain home" class=dd-item><a href=/ghpages-test/soa-domains/manage-soa-domains/delete-domain-home/><b>3. </b>Delete the SOA domain home</a></li><li data-nav-id=/ghpages-test/soa-domains/manage-soa-domains/supportjdev/ title="Deploying SOA Composites from Oracle JDeveloper" class=dd-item><a href=/ghpages-test/soa-domains/manage-soa-domains/supportjdev/><b>4. </b>Deploying SOA Composites from Oracle JDeveloper</a></li><li data-nav-id=/ghpages-test/soa-domains/manage-soa-domains/enablingt3/ title="Expose T3 protocol for Managed Servers" class="dd-item active"><a href=/ghpages-test/soa-domains/manage-soa-domains/enablingt3/><b>5. </b>Expose T3 protocol for Managed Servers</a></li><li data-nav-id=/ghpages-test/soa-domains/manage-soa-domains/persisting-soa-adapters-customizations/ title="Persisting SOA Adapters Customizations" class=dd-item><a href=/ghpages-test/soa-domains/manage-soa-domains/persisting-soa-adapters-customizations/><b>6. </b>Persisting SOA Adapters Customizations</a></li></ul></li><li data-nav-id=/ghpages-test/soa-domains/patch-soa-domains/ title="Patch SOA domains" class=dd-item><a href=/ghpages-test/soa-domains/patch-soa-domains/><b>5. </b>Patch SOA domains</a></li><li data-nav-id=/ghpages-test/soa-domains/known-issues/ title="Known Issues" class=dd-item><a href=/ghpages-test/soa-domains/known-issues/><b>6. </b>Known Issues</a></li><li data-nav-id=/ghpages-test/soa-domains/release-notes/ title="Release Notes" class=dd-item><a href=/ghpages-test/soa-domains/release-notes/>Release Notes</a></li></ul></li><li data-nav-id=/ghpages-test/wcsites-domains/ title="Oracle WebCenter Sites" class=dd-item><a href=/ghpages-test/wcsites-domains/>Oracle WebCenter Sites</a><ul><li data-nav-id=/ghpages-test/wcsites-domains/pre-requisites/ title=Pre-requisites class=dd-item><a href=/ghpages-test/wcsites-domains/pre-requisites/><b>1. </b>Pre-requisites</a></li><li data-nav-id=/ghpages-test/wcsites-domains/prepare-your-environment/ title="Prepare your environment" class=dd-item><a href=/ghpages-test/wcsites-domains/prepare-your-environment/><b>2. </b>Prepare your environment</a></li><li data-nav-id=/ghpages-test/wcsites-domains/create-wcsites-domains/ title="Create WebCenter Sites domains" class=dd-item><a href=/ghpages-test/wcsites-domains/create-wcsites-domains/><b>3. </b>Create WebCenter Sites domains</a></li><li data-nav-id=/ghpages-test/wcsites-domains/manage-wcsites-domains/ title="Manage WebCenter Sites domains" class=dd-item><a href=/ghpages-test/wcsites-domains/manage-wcsites-domains/><b>4. </b>Manage WebCenter Sites domains</a><ul><li data-nav-id=/ghpages-test/wcsites-domains/manage-wcsites-domains/loadbalancer-traefik-setup-for-wcsites-domain-setup-on-k8s/ title="a. Using Traefik Loadbalancer" class=dd-item><a href=/ghpages-test/wcsites-domains/manage-wcsites-domains/loadbalancer-traefik-setup-for-wcsites-domain-setup-on-k8s/>a. Using Traefik Loadbalancer</a></li><li data-nav-id=/ghpages-test/wcsites-domains/manage-wcsites-domains/loadbalancer-voyager-setup-for-wcsites-domain-setup-on-k8s/ title="b. Using Voyager Loadbalancer" class=dd-item><a href=/ghpages-test/wcsites-domains/manage-wcsites-domains/loadbalancer-voyager-setup-for-wcsites-domain-setup-on-k8s/>b. Using Voyager Loadbalancer</a></li><li data-nav-id=/ghpages-test/wcsites-domains/manage-wcsites-domains/elasticsearch-integration-with-wls-operator-wls-server-logs/ title="c. ELK Integration for Logs" class=dd-item><a href=/ghpages-test/wcsites-domains/manage-wcsites-domains/elasticsearch-integration-with-wls-operator-wls-server-logs/>c. ELK Integration for Logs</a></li><li data-nav-id=/ghpages-test/wcsites-domains/manage-wcsites-domains/weblogic-logging-exporter-setup/ title="d. Publish logs to Elasticsearch" class=dd-item><a href=/ghpages-test/wcsites-domains/manage-wcsites-domains/weblogic-logging-exporter-setup/>d. Publish logs to Elasticsearch</a></li><li data-nav-id=/ghpages-test/wcsites-domains/manage-wcsites-domains/weblogic-monitoring-exporter-setup/ title="e. Monitor a WebCenter Sites domain" class=dd-item><a href=/ghpages-test/wcsites-domains/manage-wcsites-domains/weblogic-monitoring-exporter-setup/>e. Monitor a WebCenter Sites domain</a></li></ul></li><li data-nav-id=/ghpages-test/wcsites-domains/known-issues/ title="Known Issues in WCSites" class=dd-item><a href=/ghpages-test/wcsites-domains/known-issues/><b>6. </b>Known Issues in WCSites</a></li><li data-nav-id=/ghpages-test/wcsites-domains/release-notes/ title="Release Notes" class=dd-item><a href=/ghpages-test/wcsites-domains/release-notes/>Release Notes</a></li></ul></li></ul><section id=footer><p>Created with <i class="fas fa-heart"></i>from <a href=https://www.oracle.com>Oracle</a></p><p>&nbsp;</p><p><a href=https://github.com/oracle/fmw-kubernetes><i class="fab fa-github"></i>GitHub repo</a></p><p><a href=https://weblogic-slack-inviter.herokuapp.com/><i class="fab fa-slack"></i>Public Slack #</a></p></section></div></nav><section id=body><div id=overlay></div><div class="padding highlightable"><div><div id=top-bar><div id=breadcrumbs itemscope itemtype=http://data-vocabulary.org/Breadcrumb><span id=sidebar-toggle-span><a href=# id=sidebar-toggle data-sidebar-toggle><i class="fas fa-bars"></i></a></span><span id=toc-menu><i class="fas fa-list-alt"></i></span><span class=links><a href=/ghpages-test/>Oracle Fusion Middleware on Kubernetes</a> > <a href=/ghpages-test/soa-domains/>Oracle SOA Suite</a> > <a href=/ghpages-test/soa-domains/manage-soa-domains/>Manage SOA Domains</a> > Expose T3 protocol for Managed Servers</span></div><div class=progress><div class=wrapper><nav id=TableOfContents><ul><li><ul><li><a href=#step-1-create-t3-channels-for-managed-servers>Step 1 : Create T3 Channels for Managed Servers</a><ul><li><a href=#method-1-using-weblogic-server-administration-console>Method 1 : Using WebLogic Server Administration Console</a></li><li><a href=#method-2-using-wlst-script>Method 2 : Using WLST Script</a></li></ul></li><li><a href=#step-2-create-kubernetes-service-to-expose-t3-port-30014-as-nodeport-service>Step 2 : Create Kubernetes Service to expose T3 port 30014 as NodePort Service</a></li></ul></li></ul></nav></div></div></div></div><div id=head-tags></div><div id=body-inner><h1>Expose T3 protocol for Managed Servers</h1><p>T3 ports for Managed Servers in Oracle SOA deployed in WebLogic Kubernetes operator Environment are not available by default.
This document provides steps to create T3 channel and the corresponding Kubernetes Service to expose the T3 protocol for Managed Servers in SOA Domain.</p><p><img src=/weblogic-kubernetes-operator/images/ExposeSOAMST3.png alt="Exposing SOA Managed Server T3 Ports"></p><p>With the following steps you will be creating T3 port at 30014 on all Managed Servers for soa_cluster with below details:</p><ul><li>Name: T3Channel_MS</li><li>Listen Port: 30014</li><li>External Listen Address: &lt;Master IP Address&gt;</li><li>External Listen Port: 30014</li></ul><p><code>Note: In case you are using different NodePort to expose T3 for Managed Server externally, then use same value for &quot;External Listen Port&quot;</code></p><h2 id=step-1-create-t3-channels-for-managed-servers>Step 1 : Create T3 Channels for Managed Servers</h2><p>WebLogic Server supports several ways to configure T3 channel. Below steps describe the methods to create T3 channel using WebLogic Server Administration Console or using WLST Scripts.</p><h3 id=method-1-using-weblogic-server-administration-console>Method 1 : Using WebLogic Server Administration Console</h3><ol><li><p>Login to WebLogic Server Administration Console and obtain the configuration lock by clicking on <strong>Lock &amp; Edit</strong></p></li><li><p>In the left pane of the Console, expand <strong>Environment</strong> and <strong>select Servers</strong>.</p></li><li><p>On the Servers page, click on the <strong>soa_server1</strong> and go to <strong>Protocols</strong> page</p><p><img src=/weblogic-kubernetes-operator/images/soa_server1_protocols.jpg alt="SOA Server Protocols"></p></li><li><p>Select <strong>Channel</strong> and then Click <strong>&ldquo;New&rdquo;</strong></p></li><li><p>Enter the Network Channel Name as say <strong>&ldquo;T3Channel_MS&rdquo;</strong>, Select Protocol as <strong>&ldquo;t3&rdquo;</strong> and Click <strong>&ldquo;Next&rdquo;</strong></p><p><img src=/weblogic-kubernetes-operator/images/soa_server1_t3_newchannel1.jpg alt="New Channel 1"></p></li><li><p>Enter Listen Port as <strong>&ldquo;30014&rdquo;</strong>, External Listen Address as <strong>&ldquo;&lt;Master IP&gt;&rdquo;</strong> and External Listen Port as <strong>&ldquo;30014&rdquo;</strong>. Leave empty for <strong>&ldquo;Listen Address&rdquo;</strong>. Click <strong>&ldquo;Finish&rdquo;</strong> to create the Network Channel for <strong>soa_server1</strong>.</p><p><img src=/weblogic-kubernetes-operator/images/soa_server1_t3_newchannel2.jpg alt="New Channel 2"></p></li><li><p>Perform step 3 to 6 for all Managed Servers in soa_cluster. When creating Network Channel for other Managed Servers, make sure to use same values as for all parameters including &ldquo;Network Channel Name&rdquo;.</p></li><li><p>To activate these changes, in the Change Center of the Administration Console, click <strong>Activate Changes</strong>.</p><p><img src=/weblogic-kubernetes-operator/images/soa_server1_t3_newchannel3.jpg alt="New Channel 3"></p></li><li><p>These changes does not require any server restarts. Once the T3 channels are created with port say 30014, proceed with creating the Kubernetes Service to access this port externally.</p></li></ol><h3 id=method-2-using-wlst-script>Method 2 : Using WLST Script</h3><p>The following steps creates a custom T3 channel for all Managed Servers with name <strong>T3Channel_MS</strong> that has a listen port <strong>listen_port</strong> and a paired public port <strong>public_port</strong>.</p><ol><li>Create <code>t3config_ms.py</code> with below content:</li></ol><pre><code class=language-Python>host = sys.argv[1]
port = sys.argv[2]
user_name = sys.argv[3]
password = sys.argv[4]
listen_port = sys.argv[5]
public_port = sys.argv[6]
public_address = sys.argv[7]
managedNameBase = sys.argv[8]
ms_count = sys.argv[9]
print('custom host : [%s]' % host);
print('custom port : [%s]' % port);
print('custom user_name : [%s]' % user_name);
print('custom password : ********');
print('public address : [%s]' % public_address);
print('channel listen port : [%s]' % listen_port);
print('channel public listen port : [%s]' % public_port);

connect(user_name, password, 't3://' + host + ':' + port)

edit()
startEdit()
for index in range(0, int(ms_count)):
  cd('/')
  msIndex = index+1
  cd('/')
  name = '%s%s' % (managedNameBase, msIndex)
  cd('Servers/%s/' % name )
  create('T3Channel_MS','NetworkAccessPoint')
  cd('NetworkAccessPoints/T3Channel_MS')
  set('Protocol','t3')
  set('ListenPort',int(listen_port))
  set('PublicPort',int(public_port))
  set('PublicAddress', public_address)
  print('Channel T3Channel_MS added ...for ' + name)
activate()
disconnect()
</code></pre><ol><li><p>Copy <code>t3config_ms.py</code> into Domain Home (e.g., <code>/u01/oracle/user_projects/domains/soainfra</code>) of Administration Server pod (e.g., soainfra-adminserver in soans namespace)</p><pre><code>$ kubectl cp t3config_ms.py soans/soainfra-adminserver:/u01/oracle/user_projects/domains/soainfra
</code></pre></li><li><p>Execute <code>wlst.sh t3config_ms.py</code> by exec into Administration Server pod with below parameters</p><ul><li>host: &lt;Master IP Address&gt;</li><li>port: 30012 <em># Administration Server T3 port</em></li><li>user_name: weblogic</li><li>password: Welcome1 <em># weblogic password</em></li><li>listen_port: 30014 <em># New port for T3 Managed Servers</em></li><li>public_port: 30014 <em># Kubernetes NodePort which will be used to expose T3 port externally</em></li><li>public_address: &lt;Master IP Address&gt;<br></li><li>managedNameBase: soa_server <em># Give Managed Server base name. For osb_cluster this will be osb_server</em></li><li>ms_count: 5 <em># Number of configured Managed Servers</em></li></ul><pre><code>Command:
$ kubectl exec -it &lt;Administration Server pod&gt; -n &lt;namespace&gt; -- /u01/oracle/oracle_common/common/bin/wlst.sh  &lt;domain_home&gt;/t3config_ms.py &lt;master_ip&gt;  &lt;t3 port on Administration Server&gt;  weblogic &lt;password for weblogic&gt; &lt;t3 port on Managed Server&gt; &lt;t3 nodeport&gt; &lt;master_ip&gt; &lt;managedNameBase&gt; &lt;ms_count&gt;
</code></pre><pre><code>Sample Command:
$ kubectl exec -it soainfra-adminserver -n soans -- /u01/oracle/oracle_common/common/bin/wlst.sh /u01/oracle/user_projects/domains/soainfra/t3config_ms.py xxx.xxx.xxx.xxx 30012 weblogic Welcome1 30014 30014 xxx.xxx.xxx.xxx soa_server 5
</code></pre></li></ol><h2 id=step-2-create-kubernetes-service-to-expose-t3-port-30014-as-nodeport-service>Step 2 : Create Kubernetes Service to expose T3 port 30014 as NodePort Service</h2><ol><li><p>Create <code>t3_ms_svc.yaml</code> with below contents to expose T3 at Managed Server port 30014 for domainName and domainUID as &ldquo;soainfra&rdquo; and cluster as &ldquo;soa_cluster&rdquo; :</p><pre><code>apiVersion: v1
kind: Service
metadata:
name: soainfra-soa-cluster-t3-external
namespace: soans
labels:
    weblogic.clusterName: soa_cluster
    weblogic.domainName: soainfra
    weblogic.domainUID: soainfra
spec:
type: NodePort
selector:
    weblogic.clusterName: soa_cluster
    weblogic.domainName: soainfra
    weblogic.domainUID: soainfra
ports:
    - name: t3port
    protocol: TCP
    port: 30014
    targetPort: 30014
    nodePort: 30014
</code></pre></li><li><p>Create the NodePort Service for port 30014 with command:</p><pre><code>$ kubectl create -f t3_ms_svc.yaml
</code></pre></li><li><p>Now you can access t3 for Managed Server with below URL</p><pre><code>t3://&lt;master_ip&gt;:30014
</code></pre></li></ol><footer class=footline></footer></div></div><div id=navigation><a class="nav nav-prev" href=/ghpages-test/soa-domains/manage-soa-domains/supportjdev/ title="Deploying SOA Composites from Oracle JDeveloper"><i class="fa fa-chevron-left"></i></a><a class="nav nav-next" href=/ghpages-test/soa-domains/manage-soa-domains/persisting-soa-adapters-customizations/ title="Persisting SOA Adapters Customizations" style=margin-right:0><i class="fa fa-chevron-right"></i></a></div></section><div style=left:-1000px;overflow:scroll;position:absolute;top:-1000px;border:none;box-sizing:content-box;height:200px;margin:0;padding:0;width:200px><div style=border:none;box-sizing:content-box;height:200px;margin:0;padding:0;width:200px></div></div><script src=/ghpages-test/js/clipboard.min.js?1584947815></script><script src=/ghpages-test/js/perfect-scrollbar.min.js?1584947815></script><script src=/ghpages-test/js/perfect-scrollbar.jquery.min.js?1584947815></script><script src=/ghpages-test/js/jquery.sticky.js?1584947815></script><script src=/ghpages-test/js/featherlight.min.js?1584947815></script><script src=/ghpages-test/js/highlight.pack.js?1584947815></script><script>hljs.initHighlightingOnLoad();</script><script src=/ghpages-test/js/modernizr.custom-3.6.0.js?1584947815></script><script src=/ghpages-test/js/learn.js?1584947815></script><script src=/ghpages-test/js/hugo-learn.js?1584947815></script><link href=/ghpages-test/mermaid/mermaid.css?1584947815 rel=stylesheet><script src=/ghpages-test/mermaid/mermaid.js?1584947815></script><script>mermaid.initialize({startOnLoad:true});</script></body></html>